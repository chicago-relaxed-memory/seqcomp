\newcommand{\UNDEFINED}{\mathbf{undef}}

\usepackage[rightbars]{changebar}
\newcommand{\textchanged}[1]{#1}
\newenvironment{changed}{\ignorespaces}{\ignorespacesafterend}
%\newcommand{\textchanged}[1]{\cbstart#1\cbend}
%\newenvironment{changed}{\cbstart\ignorespaces}{\cbend\ignorespacesafterend}
% \usepackage[framemethod=tikz]{mdframed}
% \newmdenv[
%   skipabove = \partopsep,
%   linecolor = lightgray,
%   rightmargin = 0pt,
%   innerrightmargin = 1em,
%   innertopmargin = 0pt,
%   innerbottommargin = 0pt,
%   innerleftmargin = 0pt,
%   leftmargin = 0pt,
%   linewidth = 3pt,
%   topline = false,
%   leftline = false,
%   bottomline = false
%   ]{rightbar}
\newcommand{\fextract}[1]{\mathsf{extract}\ifnotempty{#1}{(#1)}}
\newcommand{\regForm}[1]{\cForm_{#1}}%\mathsf{REG}\ifnotempty{#1}{_{#1}}}
\newcommand{\existsone}{\exists!}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\newcommand{\MRD}{{\sc mrd-c11}}
\newcommand{\PwP}{{\sc PwP}}
\newcommand{\PwT}{{\sc PwT}}
\newcommand{\PwTmca}[1]{{\sc \PwT-mca}\ifnotempty{#1}{$_{#1}$}}
\newcommand{\PwTpo}{{\sc \PwT-po}}
\newcommand{\PwTc}{{\sc \PwT-c11}}
\newcommand{\PwTTITLE}{P\lowercase{w}T}
\newcommand{\PwTmcaTITLE}[1]{\PwTTITLE-MCA{#1}}
\newcommand{\PwTcTITLE}{\PwTTITLE-C11}
\newcommand{\PwTer}{{\sc \PwT er}}
\newcommand{\PwTerTITLE}{\PwTTITLE\lowercase{er}}
\newcommand{\DEP@COLOR}[1]{\mathrel{{\color{purple}#1}}}
\newcommand{\LOC@COLOR}[1]{\mathrel{{\color{red}#1}}}
\newcommand{\SYNC@COLOR}[1]{\mathrel{{\color{magenta}#1}}}
\newcommand{\LOGIC@COLOR}[1]{{\color{blue}#1}}
\newcommand{\LABEL@COLOR}[1]{{\color{green!40!black}#1}}
\newcommand{\LABEL@COLOR@TEXT}[1]{\textcolor{green!40!black}{#1}}
\newcommand{\LABEL@COLOR@REL}[1]{\mathrel{\LABEL@COLOR{\textnormal{#1}}}}
\newcommand{\LABEL@REL}[1]{\mathrel{\textnormal{#1}}}


\newcommand{\suptesteq}{\succeq}
\newcommand{\suptest}{\succ}
\newcommand{\subtesteq}{\preceq}
\newcommand{\subtest}{\prec}
\newcommand{\ncomptest}{\mathrel{{\not\preceq}{\not\succeq}}}
\newcommand{\eqtest}{=_{\mathsf{obs}}}%\mathrel{{\preceq}{\succeq}}}
\newcommand{\makecounter}[1]{\newcounter{#1}\setcounter{#1}{\value{enumi}}}
\newcommand{\Wclass}[1][]{{[}\mathsf{W}^{#1}{]}}
\newcommand{\Rclass}[1][]{{[}\mathsf{R}^{#1}{]}}
\newcommand{\LDR}{\textnormal{\texttt{ldr}}}
\newcommand{\LDAR}{\textnormal{\texttt{ldar}}}
\newcommand{\LDAPR}{\textnormal{\texttt{ldapr}}}
\newcommand{\STR}{\textnormal{\texttt{str}}}
\newcommand{\STLR}{\textnormal{\texttt{stlr}}}
\newcommand{\DMBLD}{\textnormal{\texttt{dmb}.\texttt{ld}}}
\newcommand{\DMBST}{\textnormal{\texttt{dmb}.\texttt{st}}}
\newcommand{\DMBSY}{\textnormal{\texttt{dmb}.\texttt{sy}}}

\newcommand{\low}[1]{\llfloor#1\rrfloor}
\newcommand{\aRel}{R}
\newcommand{\rsfencesdeftext}{\LABEL@COLOR@TEXT{\emph{strongly-fences}}}
\newcommand{\rsmatchesdeftext}{\LABEL@COLOR@TEXT{\emph{strongly-matches}}}
\newcommand{\rsoverlapsdeftext}{\LABEL@COLOR@TEXT{\emph{strongly-overlaps}}}
\newcommand{\roverlapsdef}{\LABEL@COLOR@REL{\emph{overlaps}}}
\newcommand{\rmatchesdef}{\LABEL@COLOR@REL{\emph{matches}}}
\newcommand{\rblocksdef}{\LABEL@COLOR@REL{\emph{blocks}}}
\newcommand{\rsfencesdef}{\LABEL@COLOR@REL{\emph{strongly-fences}}}
\newcommand{\rsmatchesdef}{\LABEL@COLOR@REL{\emph{strongly-matches}}}
\newcommand{\rsoverlapsdef}{\LABEL@COLOR@REL{\emph{strongly-overlaps}}}
%\newcommand{\rsmatchesblocksdef}{\LABEL@COLOR@REL{\emph{strongly-matches/blocks}}}
\newcommand{\rdelayspdef}{\LABEL@COLOR@REL{\emph{delays}}'}
\newcommand{\rdelaysdef}{\LABEL@COLOR@REL{\emph{delays}}}
\newcommand{\rcodelaysdef}{\LABEL@COLOR@REL{\emph{co-delays}}}
\newcommand{\rsyncdelaysdef}{\LABEL@COLOR@REL{\emph{sync-delays}}}
\newcommand{\sreaddef}{\LABEL@COLOR@REL{\emph{read}}}
\newcommand{\sreleasedef}{\LABEL@COLOR@REL{\emph{release}}}
\newcommand{\rimpliesdef}{\mathrel{\vDash}}%{\LABEL@COLOR@REL{\emph{implies}}}
\newcommand{\rextendsdef}[2]{\LABEL@REL{\emph{respects}}\ifnotempty{#1#2}{{#1}\ifnotempty{#2}{\;\allowbreak\textnormal{\emph{and}}\;\allowbreak{#2}}}}

\newcommand{\roverlap}{\LABEL@COLOR@REL{{overlap}}}
\newcommand{\roverlaps}{\LABEL@COLOR@REL{{overlaps}}}
\newcommand{\rmatches}{\LABEL@COLOR@REL{{matches}}}
\newcommand{\rblocks}{\LABEL@COLOR@REL{{blocks}}}
\newcommand{\rsfences}{\LABEL@COLOR@REL{{strongly-fences}}}
\newcommand{\rsmatches}{\LABEL@COLOR@REL{{strongly-matches}}}
\newcommand{\rsoverlaps}{\LABEL@COLOR@REL{{strongly-overlaps}}}
\newcommand{\rsoverlap}{\LABEL@COLOR@REL{{strongly-overlap}}}
\newcommand{\rdelaysp}{\LABEL@COLOR@REL{{delays}}'}
\newcommand{\rdelays}{\LABEL@COLOR@REL{{delays}}}
\newcommand{\rdelay}{\LABEL@COLOR@REL{{delay}}}
\newcommand{\rcodelays}{\LABEL@COLOR@REL{{co-delays}}}
\newcommand{\rsyncdelays}{\LABEL@COLOR@REL{{sync-delays}}}
\newcommand{\sread}{\LABEL@COLOR@REL{{read}}}
\newcommand{\srelease}{\LABEL@COLOR@REL{{release}}}
\newcommand{\rimplies}{\mathrel{\vDash}}%{\LABEL@COLOR@REL{{implies}}}}
\newcommand{\rnotimplies}{\mathrel{\not\vDash}}%{\LABEL@COLOR@REL{{implies}}}}
\newcommand{\riff}{\mathrel{\equiv}}
%\newcommand{\riff}{\mathrel{\Dashv\vDash}}
\newcommand{\rextends}[2]{\LABEL@REL{{respects}}\ifnotempty{#1#2}{{#1}\ifnotempty{#2}{\textand{#2}}}}
%\newcommand{\rextends}[2]{\supseteq({#1}\cup{#2})}
\newcommand{\rsupset}[2]{\supseteq({#1}\cup{#2})}
\newcommand{\rsubset}[2]{\subseteq({#1}\cup{#2})}

\newcommand{\Cb}{,\allowbreak}
\newcommand{\Cc}{,\;\allowbreak}
\newcommand{\fcard}[1]{{|}#1{|}}
\newcommand{\Cdown}[1]{\smash{\downarrow}#1}
\newcommand{\lubscope}{\sqcup}
\newcommand{\ltscope}{\sqsubset}
\newcommand{\lescope}{\sqsubseteq}
\newcommand{\lubmode}{\sqcup}
\newcommand{\ltmode}{\sqsubset}
\newcommand{\lemode}{\sqsubseteq}
\newcommand{\gemode}{\sqsupseteq}
\newcommand{\fcoalesce}[1]{\pi\ifnotempty{#1}{(#1)}}
\newcommand{\fmerge}[2]{\mathsf{merge}\ifnotempty{#1#2}{\allowbreak(#1,\;\allowbreak#2)}}
\newcommand{\Pom}{\mathsf{Pom}}
\newcommand{\PomPre}{\mathsf{PomPre}}
\newcommand{\PomTrans}{\mathsf{PomTrans}}
\newcommand{\fid}{\mathsf{id}}
\newcommand{\NEG}[1]{\texttt{-}#1}
\newcommand{\bigstep}[3]{(#1,#2)\Downarrow#3}
\newcommand{\aState}{\sigma}
\newcommand{\bState}{\rho}

\newcommand{\noSUB}[1]{#1}
\newcommand{\noOR}[1]{#1}
\newcommand{\reflem}[1]{Lemma~\ref{#1}}
\newcommand{\refthm}[1]{Theorem~\ref{#1}}
\newcommand{\reffig}[1]{Fig.~\ref{#1}}
\newcommand{\refdef}[1]{Def.~\ref{#1}}
\newcommand{\refex}[1]{Example~\ref{#1}}
\newcommand{\refexs}[2]{Examples~\ref{#1}/\ref{#2}}
\newcommand{\suchthat}{\mid}
\newcommand{\TICK}{\checkmark\!}
% \newcommand{\QL}[2]{\mathsf{ql}_{#2}^{#1}}
% \newcommand{\DL}[3]{#3\,\mathsf{dl}_{#2}^{#1}}
% \newcommand{\QS}[2]{\mathsf{qs}_{#2}^{#1}}
% \newcommand{\DS}[3]{#3\,\mathsf{ds}_{#2}^{#1}}
% \newcommand{\DS}[3]{\mathsf{ds}_{#2}^{#1}#3}
% \newcommand{\DSP}[3]{(#3)\mathsf{ds}_{#2}^{#1}}
\newcommand{\QL}[2]{\smash{\mathsf{Q}_{#2}^{\mathsf{L}#1}}}
\newcommand{\QS}[2]{\smash{\mathsf{Q}_{#2}^{\mathsf{S}#1}}}
\newcommand{\QF}[2]{\smash{\mathsf{Q}_{#2}^{\mathsf{F}#1}}}
\newcommand{\DS}[2]{{[}{#2}/\Dx{#1}{]}}
\newcommand{\DL}[2]{\mathord{\downarrow^{#1}_{#2}}}
\newcommand{\DLX}[3]{\mathord{\downarrow^{#1}_{#2,#3}}}

\newcommand{\Qmode}[1]{\mathsf{Q}^{#1}}
\newcommand{\Dmode}[1]{\Dx{#1}}
\newcommand{\RW}{\mathsf{W}}
\newcommand{\RO}{\lnot\mathsf{W}}
\newcommand{\Q}[1]{\mathsf{Q}_{#1}}
\newcommand{\Qstar}{\mathsf{Q}^{*}}
\newcommand{\D}{\Dx{\texttt{*}}}
\newcommand{\Dx}[1]{\mathord{\downarrow^{#1}}}
\newcommand{\Qx}[1]{\mathsf{Q}_{\mathsf{rw}}^{#1}}
\newcommand{\Qr}[1]{\mathsf{Q}_{\mathsf{ro}}^{#1}}
\newcommand{\Qw}[1]{\mathsf{Q}_{\mathsf{wo}}^{#1}}
\newcommand{\Qsc}{\mathsf{Q}_{\mathsf{sc}}}
\newcommand{\Qra}{\mathsf{Q}_{\mathsf{acq}}}
\newcommand{\Qrlx}{\mathsf{Q}^{*}}%_{\mathsf{rlx}}}
\newcommand{\DxREF}[1]{\Dx{\REF{#1}}}
\newcommand{\QxREF}[1]{\Qx{\REF{#1}}}
\newcommand{\QwREF}[1]{\Qw{\REF{#1}}}
\newcommand{\SB}[1]{}%_{#1}}
\newcommand{\limplies}{\mathbin{\Rightarrow}}
\newcommand{\lassume}[1]{\underline{#1}}

% \begin{wrapfigure}{r}{0mm}%
%   \centering\rule{3cm}{7cm}
% \end{wrapfigure}%
%\wrapfigsafe{r}{0mm}{\centering\rule{1cm}{.5cm}}
\usepackage{wrapfig}
\setlength{\intextsep}{0.0pt plus 2.0pt minus 2.0pt}
\newsavebox\curwrapfig
\newcommand{\wrapfigsafe}[4][]{%
  \sbox\curwrapfig{#4}%
  %\par\penalty-100%
  \begingroup % preserve \dimen@
    \dimen@\pagegoal \advance\dimen@-\pagetotal % space left
    \advance\dimen@-\baselineskip % allow an extra line
    \ifdim \ht\curwrapfig>\dimen@ % not enough space left
      \break%
    \fi%
  \endgroup%
  \begin{wrapfigure}[#1]{#2}{#3}%
    \usebox\curwrapfig%
  \end{wrapfigure}%
}
\usepackage{subcaption}
\usepackage{pifont}
\newcommand{\qmark}{{\color{blue!80!black}\text{?}}}
\newcommand{\cmark}{{\color{green!80!black}\text{\ding{51}}}}
\newcommand{\xmark}{{\color{red!80!black}\text{\ding{55}}}}
\newcommand{\QMARK}{\makebox[0pt][l]{\;\;\;\;\qmark}}
\newcommand{\CMARK}{\makebox[0pt][l]{\;\;\;\;\cmark}}
\newcommand{\XMARK}{\makebox[0pt][l]{\;\;\;\;\xmark}}

% recommended by ACM
%\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{microtype}
\clubpenalty = 10000
\widowpenalty = 10000
\displaywidowpenalty = 10000

% % To get agda, use xelatex or luatex
% % Translation of unicode to latex: 
% \usepackage{ucs}
% \usepackage[utf8x]{inputenc}
% \usepackage{autofe}
% % Targets of unicode translation:
% \usepackage{amssymb}
% \usepackage{bbm}
% \usepackage[greek,english]{babel}
% % Additional unicode
% \DeclareUnicodeCharacter{8988}{\ensuremath{\ulcorner}}
% \DeclareUnicodeCharacter{8989}{\ensuremath{\urcorner}}
% \DeclareUnicodeCharacter{8803}{\ensuremath{\overline{\equiv}}}
% % for code
% \usepackage{fancyvrb}
% \DefineVerbatimEnvironment{code}{Verbatim}{fontfamily=helvetica,fontsize=\small} % Add fancy options here if you like.

%\usepackage{anyfontsize}
\usepackage{mathtools}
\usepackage[inline]{enumitem}
\setlist[enumerate,2]{label=(\theenumi\alph*),ref=\theenumi\alph*}
\setlist[enumerate,3]{label=(\roman*),ref=\theenumii(\roman*)}
% \setlist[enumerate,1]{leftmargin = 1.6\parindent, topsep = 0.2\baselineskip}
% \setlist[itemize,1]{leftmargin = 1.6\parindent, topsep = 0.2\baselineskip}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{cleveref}
\usepackage{hyphenat}
\usepackage{xparse}
\usepackage{verbatim}
\usepackage{stmaryrd}
\usepackage{soul}
\sethlcolor{lightgray}
\newcommand{\hlfancy}[2]{\sethlcolor{#1}\hl{#2}}
\usepackage{alltt}
\usepackage{float}
% \begin{multicols}{2}
%   \columnbreak
% \end{multicols}
\usepackage{multicol}
\setlength{\multicolsep}{0.0pt plus 2.0pt minus 0.0pt} % vertical spacing above and below
\setlength{\columnsep}{.3pc} %spacing between columns

% \usepackage{makecell}
% \usepackage[defblank]{paralist}
% \usepackage[caption=false]{subfig}



\newcommand{\floc}{\mathsf{loc}}

\newcommand{\mathhl}[1]{\!\!\smash{\colorbox{gray!20!white}{$\displaystyle \mathstrut\smash{#1}$}}\!\!}
\newcommand{\mathhlscript}[1]{\!\!\smash{\colorbox{gray!20!white}{$\scriptstyle {#1}$}}\!\!}

\newcommand{\classC}{\texttt{C}}
\newcommand{\classD}{\texttt{D}}

\newcounter{mybookmark}
\newcommand{\myparagraph}[2][]{\subsubsection*{#2}\stepcounter{mybookmark}\belowpdfbookmark{#2}{mybookmark\arabic{mybookmark}}\ifnotempty{#1}{\labeltext[#2]{}{#1}}}
%\newcommand{\myparagraph}[2][]{\subsection{#2}\ifnotempty{#1}{\label{sec:#1}\labeltext[\textsection\ref{sec:#1}]{}{#1}}}
\newcommand{\bookmark}[1]{\stepcounter{mybookmark}\belowpdfbookmark{#1}{mybookmark\arabic{mybookmark}}}

\newcommand{\mRLXquiet}{{}}
\newcommand{\Rdis}[2]{\mathsf{weaken}_{\mathsf{R}#1#2}}
\newcommand{\Wdis}[2]{\mathsf{weaken}_{\mathsf{W}#1#2}}

\newcommand{\cmdI}{\aCmd_{\mathrm{I}}}
\newcommand{\cmdC}{\aCmd_{\mathsf{C}}}
\newcommand{\cmdR}{\aCmd_{\mathsf{R}}}
\newcommand{\cmdW}{\aCmd_{\mathsf{W}}}
\newcommand{\PS}[1]{\textnormal{\textsc{ps#1}}}
\newcommand{\pc}{\textnormal{\textsc{pc}}}
\newcommand{\pcs}{\textnormal{\textsc{pc}s}}

\newif\ifshowRA
\showRAtrue
\newif\ifshowSCOPE
\showSCOPEtrue
\NewDocumentCommand\PRField{O{} m m O{} m}{\ifnotempty{#5}{{#5} \GETS}{#2.#3}^{#1}_{#4}}
\NewDocumentCommand\PWField{O{} m m O{} m}{{#2.#3}^{#1}_{#4} \GETS #5}

\newcommand{\sem}[2][]{\llbracket\ifemptyelse{#2}{\cdot}{#2}\rrbracket\ifshowSCOPE_{#1}\fi}
\newcommand{\semmca}[2]{\llbracket\ifemptyelse{#2}{\cdot}{#2}\rrbracket_{\mathsf{mca}{#1}}}
\newcommand{\sempomca}[2]{\llbracket\ifemptyelse{#2}{\cdot}{#2}\rrbracket_{\mathsf{mca}{#1}}^{\mathsf{po}}}
\newcommand{\sempo}[1]{\llbracket\ifemptyelse{#1}{\cdot}{#1}\rrbracket^{\mathsf{po}}}
\newcommand{\sembase}[1]{\llbracket\ifemptyelse{#1}{\cdot}{#1}\rrbracket}%_1}
\newcommand{\semrr}[1]{\llbracket\ifemptyelse{#1}{\cdot}{#1}\rrbracket}%_2}
\newcommand{\semreg}[1]{\llbracket\ifemptyelse{#1}{\cdot}{#1}\rrbracket}%_3}
\newcommand{\semaddr}[1]{\llbracket\ifemptyelse{#1}{\cdot}{#1}\rrbracket}%_4}
\newcommand{\semca}[1]{\llbracket\ifemptyelse{#1}{\cdot}{#1}\rrbracket}%_5}
\newcommand{\semcaaddr}[1]{\llbracket\ifemptyelse{#1}{\cdot}{#1}\rrbracket}%_6}
\newcommand{\frf}[1]{#1}%\ensuremath{^{\mathsf{rf}}}}
\newcommand{\fpo}[1]{\mathsf{po}#1}

\NewDocumentCommand\PF{O{} m}{\texttt{F}^{#2}\ifshowSCOPE_{#1}\fi}
\NewDocumentCommand\DF{O{} m O{}}{\ifshowSCOPE#3\fi\mathsf{F}^{#2}\ifshowSCOPE_{#1}\fi}
\NewDocumentCommand\DFP{O{} m O{}}{\PBR{\DF[#1]{#2}[#3]}}
\NewDocumentCommand\DG{O{} m m O{}}{\ifshowSCOPE#4\fi\mathsf{F}^{#2}\ifshowSCOPE_{#1}\fi\,#3}
\NewDocumentCommand\DGP{O{} m m O{}}{\PBR{\DG[#1]{#2}{#3}[#4]}}

\NewDocumentCommand\PCAS{O{} O{} m O{} m m m}{\ifnotempty{#5}{{#5} \GETS}\CAS^{#1\ifnotempty{#2}{,#2}}\ifshowSCOPE_{#4}\fi \ifnotempty{#3}{\texttt{(}#3,#6,#7\texttt{)}}}
\NewDocumentCommand\PFADD{O{} O{} m O{} m m}{\ifnotempty{#5}{{#5} \GETS}\FADD^{#1\ifnotempty{#2}{,#2}}\ifshowSCOPE_{#4}\fi \ifnotempty{#3}{\texttt{(}#3,#6\texttt{)}}}
\NewDocumentCommand\PINC{O{} O{} m O{} m}{\ifnotempty{#5}{{#5} \GETS}\INC^{#1\ifnotempty{#2}{,#2}}\ifshowSCOPE_{#4}\fi \ifnotempty{#3}{\texttt{(}#3\texttt{)}}}
\NewDocumentCommand\PEXCHG{O{} O{} m O{} m m}{\ifnotempty{#5}{{#5} \GETS}\EXCHG^{#1\ifnotempty{#2}{,#2}}\ifshowSCOPE_{#4}\fi \ifnotempty{#3}{\texttt{(}#3,#6\texttt{)}}}

\newcommand{\DRreg}[3]{#1\DR{#2}{#3}}
\NewDocumentCommand\PR{O{} m O{} m}{\ifnotempty{#4}{{#4} \GETS}{#2}^{#1}\ifshowSCOPE_{#3}\fi}
\NewDocumentCommand\PRP{O{} m O{} m}{\PBR{\PR[#1]{#2}[#3]{#4}}}
\NewDocumentCommand\DR{O{} m O{} m O{}}{\ifshowSCOPE#5\fi\mathsf{R}^{\ifshowRA#1\fi}\ifshowSCOPE_{#3}\fi\ifnotempty{#2}{\mkern1mu#2}\ifnotempty{#4}{\mkern1mu#4}}
\NewDocumentCommand\DRP{O{} m O{} m O{}}{\PBR{\DR[#1]{#2}[#3]{#4}[#5]}}

\NewDocumentCommand\DX{O{} m O{} m O{}}{\ifshowSCOPE#5\fi\mathsf{A}^{\ifshowRA#1\fi}\ifshowSCOPE_{#3}\fi\ifnotempty{#2}{\mkern1mu#2\ifnotempty{#4}{\mkern1mu#4}}}
\NewDocumentCommand\DXP{O{} m O{} m O{}}{\PBR{\DX[#1]{#2}[#3]{#4}[#5]}}

\NewDocumentCommand\PW{O{} m O{} m}{{#2}^{#1}\ifshowSCOPE_{#3}\fi \GETS #4}
\NewDocumentCommand\PWP{O{} m O{} m}{\PBR{\PW[#1]{#2}[#3]{#4}}}
\NewDocumentCommand\DW{O{} m O{} m O{}}{\ifshowSCOPE#5\fi\mathsf{W}^{\ifshowRA#1\fi}\ifshowSCOPE_{#3}\fi\ifnotempty{#2}{\mkern0mu#2\ifnotempty{#4}{\mkern1mu#4}}}
\NewDocumentCommand\DWP{O{} m O{} m O{}}{\PBR{\DW[#1]{#2}[#3]{#4}[#5]}}

\NewDocumentCommand\PRREF{O{} m O{} m}{\ifnotempty{#4}{{#4} \GETS}{\REF{#2}}^{#1}\ifshowSCOPE_{#3}\fi}
\NewDocumentCommand\DRREF{O{} m O{} m O{}}{\ifshowSCOPE#5\fi\mathsf{R}^{\ifshowRA#1\fi}\ifshowSCOPE_{#3}\fi\ifnotempty{#2}{\mkern1mu\REF{#2}\ifnotempty{#4}{\mkern1mu#4}}}
\NewDocumentCommand\DRREFP{O{} m O{} m O{}}{\PBR{\DRREF[#1]{#2}[#3]{#4}[#5]}}

\NewDocumentCommand\PWREF{O{} m O{} m}{{\REF{#2}}^{#1}\ifshowSCOPE_{#3}\fi \GETS #4}
\NewDocumentCommand\DWREF{O{} m O{} m O{}}{\ifshowSCOPE#5\fi\mathsf{W}^{\ifshowRA#1\fi}\ifshowSCOPE_{#3}\fi\ifnotempty{#2}{\mkern0mu\REF{#2}\ifnotempty{#4}{\mkern1mu#4}}}
\NewDocumentCommand\DWREFP{O{} m O{} m O{}}{\PBR{\DWREF[#1]{#2}[#3]{#4}[#5]}}

\NewDocumentCommand\PA{m m}{\texttt{await}\,#1\,\EQ\,#2}
\NewDocumentCommand\DA{m m}{\mathsf{A}\ifnotempty{#1}{\mkern1mu#1\ifnotempty{#2}{\mkern1mu#2}}}
\NewDocumentCommand\DAP{m m}{\PBR{\DA{#1}{#2}}}

% \NewDocumentCommand\PAR{O{} O{}}{\mathrel{\ifnotempty{#1}{{}_{#1}}\texttt{\textbf{|}}\mkern-6mu\texttt{\textbf{|}}\ifnotempty{#2}{_{#2}}}}
%\newcommand{\LPAR}{\,\mathbin{\rrceil}\,}
%\NewDocumentCommand\LPAR{O{}}{\mathrel{\rrceil\ifnotempty{#1}{\ifshowSCOPE_{#1}\fi}}}
%\NewDocumentCommand\RPAR{O{}}{\mathrel{\ifnotempty{#1}{\ifshowSCOPE{}_{#1}\!\fi}\llceil}}
\NewDocumentCommand\LPAR{O{}}{\mathrel{\mkern5mu\makebox[0pt][l]{$\PAR$}\mkern-10mu\leftarrow\ifnotempty{#1}{\ifshowSCOPE\mkern-8mu{}_{#1}\fi}}}
\NewDocumentCommand\RPAR{O{}}{\mathrel{\ifnotempty{#1}{\ifshowSCOPE{}_{#1}\fi}\makebox[0pt][l]{$\PAR$}\mkern-9mu\rightarrow}}
%\NewDocumentCommand\PAR{O{} O{}}{\mathrel{\ifnotempty{#1}{\ifshowSCOPE{}_{#1}\fi}\mathord\parallel\ifshowSCOPE\ifnotempty{#2}{_{#2}}\fi}}
\NewDocumentCommand\PAR{O{}}{\mathrel{\parallel}\ifshowSCOPE\ifnotempty{#1}{_{#1}}\fi}
%\NewDocumentCommand\sRPAR{O{} O{}}{\mathrel{\ifnotempty{#1}{{}_{#1}}\makebox[0pt][l]{$\sPAR$}\mkern-9mu\rightarrow\ifnotempty{#2}{_{#2}}}}
% \newcommand{\RPAR}{\,\mathbin{\texttt{\textbf{|}}\mkern-6mu\texttt{\textbf{|}}\mkern-5mu\raisebox{.7ex}{\texttt{\textbf{-}}}\mkern-3mu}\,}

\newcommand{\LET}[2]{#1\GETS#2}
\newcommand{\PRED}[2][\aForm]{#2 \mid #1}
\newcommand{\PREDP}[2][\aForm]{\ABR{\PRED[#1]{#2}}}
\newcommand{\ABR}[1]{\langle#1\rangle}
\newcommand{\ABRbig}[1]{\bigl\langle#1\bigr\rangle}
\newcommand{\CBR}[1]{\{#1\}}
\newcommand{\CBRbig}[1]{\bigl\{#1\bigr\}}
\newcommand{\PBR}[1]{(#1)}
\newcommand{\PBRbig}[1]{\bigl(#1\bigr)}
\newcommand{\SBR}[1]{{[}#1{]}}
\newcommand{\SBRbig}[1]{\bigl{[}#1\bigr{]}}


% \NewDocumentCommand\DR{O{} O{} m m}{\mathsf{R}^{#1}\ifnotempty{#3}{\mkern1mu#3\ifnotempty{#4}{\mkern1mu#4}}}
% \NewDocumentCommand\DW{O{} O{} m m}{\mathsf{W}^{#1}\ifnotempty{#3}{\mkern0mu#3\ifnotempty{#4}{\mkern1mu#4}}}
% \NewDocumentCommand \PAR {O{} O{}}{\,\mathbin{\texttt{\textbf{|}}\mkern-6mu\texttt{\textbf{|}}}\,}
% \newcommand{\sem}[2][]{\llbracket#2\rrbracket_{#1}}
% \NewDocumentCommand\DR{O{} O{} m m}{#2\mathsf{R}^{#1}\ifnotempty{#3}{\mkern1mu#3\ifnotempty{#4}{\mkern1mu#4}}}
% \NewDocumentCommand\DW{O{} O{} m m}{#2\mathsf{W}^{#1}\ifnotempty{#3}{\mkern0mu#3\ifnotempty{#4}{\mkern1mu#4}}}
% \NewDocumentCommand \PAR {O{} O{}}{\,\mathbin{{}_{#1}\mkern-2mu\texttt{\textbf{|}}\mkern-6mu\texttt{\textbf{|}}\mkern-1mu{}_{#2}}\,}

%https://tex.stackexchange.com/questions/438876/how-to-cross-reference-text-with-a-custom-label-reference-text
% \labeltext[optional short ref]{the labeled text}{label name}
\newcommand{\labeltextsc}[3][]{%
    \@bsphack%
    \csname phantomsection\endcsname% in case hyperref is used
    \def\tst{#1}%
    \def\labelmarkup##1{\textnormal{\textsc{\lowercase{##1}}}}% How to markup the label itself
    %\def\refmarkup{\labelmarkup}% How to markup the reference
    \def\refmarkup##1{\textnormal{\textsc{\lowercase{##1}}}}% How to markup the label itself
    \ifx\tst\empty\def\@currentlabel{\refmarkup{#2}}{\label{#3}}%
    \else\def\@currentlabel{\refmarkup{#1}}{\label{#3}}\fi%
    \@esphack%
    \labelmarkup{#2}% visible printed text.
  }
\newcommand{\labeltext}[3][]{%
    \@bsphack%
    \csname phantomsection\endcsname% in case hyperref is used
    \def\tst{#1}%
    \def\labelmarkup{}% How to markup the label itself
    %\def\refmarkup{\labelmarkup}% How to markup the reference
    \def\refmarkup{}%
    \ifx\tst\empty\def\@currentlabel{\refmarkup{#2}}{\label{#3}}%
    \else\def\@currentlabel{\refmarkup{#1}}{\label{#3}}\fi%
    \@esphack%
    \labelmarkup{#2}% visible printed text.
  }
\newcommand{\labeltextX}[3]{%
  \@bsphack%
  \csname phantomsection\endcsname% in case hyperref is used
  \def\@currentlabel{\textsc{#2}#1}{\label{#3}}%
  \@esphack%
}
\newcommand{\labeltextXX}[3]{%
  \@bsphack%
  \csname phantomsection\endcsname% in case hyperref is used
  \def\@currentlabel{\textsc{#2}#1}{\label{#3}}%
  \@esphack%
  (\textsc{#2}#1)%
}
%\newcommand{\imm}{\restrict{\mathrm{imm}}}
% \renewcommand{\@fnsymbol}[1]{\ensuremath{\ifcase#1\or
%     \dagger\dagger\or
%     **\or
%     \P\P\or
%     \P\else\@ctrerr\fi}}

\newcommand{\DSTOP}[1][]{\checkmark_{#1}} 
\newcommand{\stopPS}{\textsf{SKIP}}
\newcommand{\taglabel}[2][]{\tag{$\textnormal{\textsc{\lowercase{#2}}}_{\textnormal{\textsc{\lowercase{#1}}}}$}\label{#2#1}}
\newcommand{\taglabelp}[1]{\tag{\textsc{\lowercase{#1}}$'$}\label{#1p}}
\newcommand{\taglabelpp}[1]{\tag{\textsc{\lowercase{#1}}$''$}\label{#1pp}}
\newcommand{\ignore}[1]{}
\newcommand{\todo}[1]{\textcolor{red}{[Todo: #1]}}
\newcommand{\slt}{\vartriangleleft}
\newcommand{\sle}{\trianglelefteq}
\newcommand{\tvalpom}{modal pomset}
\newcommand{\tsem}[1]{\llbracket#1\rrbracket_{{\bf M}}}
\newcommand{\tsemsc}[1]{\llbracket#1\rrbracket_{{\bf MSC}}}
\newcommand{\tsemClosed}[1]{\closed\tsem{#1}}
\newcommand{\readc}{{\mathsf{read}}}
\newcommand{\readsem}[1]{\mathsf{read}\sem{#1}}

\newcommand{\semRW}[2]{\sem{#1\mid#2}}
\newcommand{\coverEnd}{\mathsf{endCover}\guard}
\newcommand{\aSubC}{\aSub}
\newcommand{\notonce}{}
\newcommand{\weakestmo}{\textnormal{\textsc{weak\-est\-mo}}}
\newcommand{\semold}[1]{\mathsf{old}\ifnotempty{#1}{\sem{#1}}}
\newcommand{\aCtxt}{\mathbb{C}}
\newcommand{\bCtxt}{\mathbb{D}}
\newcommand{\aLocLoc}{\aLoc_{{loc}}}
\newcommand{\aRead}{\aLoc_{r}}
\newcommand{\aChanged}{\aLoc_{c}}
\newcommand{\linV}[1]{#1_{{\tt lin}}}


\newcommand{\READS}{\mathsf{reads}}
\newcommand{\drs}{\mathsf{mdrs}}
\newcommand{\SUBDRS}[1]{\mathcal{R}({#1})}
\newcommand{\DISJUNCT}{\mathsf{dpw}}
\newcommand{\aLocReg}{\varkappa}
\newcommand{\bLocReg}{\varkappa'}
\newcommand{\SUBEMP}{\SUB{}}
\newcommand{\SUB}[1]{\langle#1\rangle}
\newcommand{\SUBPAR}[2]{\SUB{#1,\,#2}}
\newcommand{\SUBAPP}{\mathbin{\ast}}
\newcommand{\SUBSEQ}{\mathbin{;}}
\newcommand{\emptypomset}{\emptyset}%\mathsf{empty}}
\newcommand{\notdisjoint}[2]{#1\cap#2\neq\emptyset}
\newcommand{\disjoint}[2]{#1\cap#2=\emptyset}
\newcommand{\disjointsmall}[2]{#1{\cap}#2{=}\emptyset}
\newcommand{\COMPAT}{\mathsf{compat}}
\newcommand{\PRE}[1]{\nabla #1}%\mathsf{pre}}
\newcommand{\POST}[2]{\Delta #1}%\mathsf{pre}}
\newcommand{\CLOSE}[1]{\mathsf{close}\ifnotempty{#1}{\bigl(#1\bigr)}}
\newcommand{\ORDER}{\lt'}%\lessdot}
\newcommand{\killS}{\mathsf{kill}\guard}
\newcommand{\nofootnote}[1]{}
\newcommand{\pole}[1]{\lessdot_{#1}}

\newcommand{\anexternal}{a }
\newcommand{\external}{}
\newcommand{\externally}{}

\newcommand{\xLIR}{\textnormal{\textsc{lir}}}
\newcommand{\xRecycle}{\textnormal{\textsc{alpha}}}
\newcommand{\xDGR}{\textnormal{\textsc{dgr}}}
\newcommand{\xRRD}{\textnormal{\textsc{rrd}}}
\newcommand{\xRMW}{\textnormal{\textsc{rmw}}}
\newcommand{\xFENCE}{\textnormal{\textsc{fence}}}
\newcommand{\xIF}{\textnormal{\textsc{if}}}
\newcommand{\xADDR}{\textnormal{\textsc{addr}}}
\newcommand{\xCO}{\textnormal{\textsc{co}}}
\newcommand{\xRASC}{\textnormal{\textsc{sync}}}
% \newcommand{\xDGR}{{\text{DGR}}}
% \newcommand{\xRRD}{{\text{RRD}}}
% \newcommand{\xIF}{{\text{If}}}
% \newcommand{\xADDR}{{\text{Addr}}}
% \newcommand{\xCO}{{\text{Co}}}
% \newcommand{\xRASC}{{\text{RASC}}}

\newcommand{\Mode}{\mathcal{M}}
\newcommand{\fmode}{\mu}
\newcommand{\amode}{\mu}
\newcommand{\bmode}{\nu}
\newcommand{\xmode}{\amode}
\newcommand{\mWK}{{\mathsf{wk}}}
\newcommand{\mACQ}{{\mathsf{acq}}}
\newcommand{\mREL}{{\mathsf{rel}}}
\newcommand{\mRA}{{\mathsf{ra}}}
\newcommand{\mSC}{{\mathsf{sc}}}
\newcommand{\mRLX}{{\mathsf{rlx}}}
\newcommand{\fREL}{{\mathsf{rel}}}
\newcommand{\fACQ}{{\mathsf{acq}}}
\newcommand{\fRA}{{\mathsf{ra}}}
\newcommand{\fSC}{{\mathsf{sc}}}

\newcommand{\Scope}{\Sigma}
\newcommand{\ascope}{\sigma}
\newcommand{\bscope}{\rho}
\newcommand{\xscope}{\ascope}
\newcommand{\sCTA}{{\mathsf{cta}}}
\newcommand{\sGPU}{{\mathsf{gpu}}}
\newcommand{\sSYS}{{\mathsf{sys}}}
\newcommand{\rms}{\mathrel{\mathsf{ms}}}
\newcommand{\xms}{\mathrel{\smash{\xleftrightarrow{\rms}}}}
\newcommand{\rsmatch}{\mathrel{\mathsf{sm}}}
\newcommand{\xsmatch}{\mathrel{\smash{\xleftrightarrow{\rsmatch}}}}
\newcommand{\rsblock}{\mathrel{\mathsf{sb}}}
\newcommand{\xsblock}{\mathrel{\smash{\xleftrightarrow{\rsblock}}}}
\newcommand{\xsmatchblock}{\mathrel{\smash{\xleftrightarrow{\rsmatch/\rsblock}}}}
\newcommand{\rcta}{\mathrel{\sCTA}}
\newcommand{\xcta}{\mathrel{\smash{=_{\rcta}}}}
\newcommand{\rgpu}{\mathrel{\sGPU}}
\newcommand{\xgpu}{\mathrel{\smash{=_{\rgpu}}}}
\newcommand{\rsys}{\mathrel{\sSYS}}
\newcommand{\xsys}{\mathrel{\smash{=_{\rsys}}}}
\newcommand{\topThrd}{\mathbf{0}}
%\newcommand{\testThrd}{\mathbf{1}}
% \newcommand{\fthrd}{\mathsf{thread}}
\newcommand{\Thrd}{\mathcal{T}}
\newcommand{\xThrd}{\aThrd}
\newcommand{\aThrd}{\alpha}
\newcommand{\bThrd}{\gamma}
\newcommand{\cThrd}{\delta}
% \newcommand{\aScp}{\aThrd}
% \newcommand{\bScp}{\bThrd}
% \newcommand{\cScp}{\cThrd}

\newcommand{\aSym}{\mathsf{s}}

%\newcommand{\amsqed}{\tag*{\QEDSYMBOL}\NoEndMark}

\newcommand{\hole}[1]{\ifnotemptyelse{#1}{[{#1}]}{[\textnormal{--}]}}
\newcommand{\fsat}{\mathsf{sat}}
\newcommand{\freadsat}{\mathsf{readsat}}
% \newcommand{\ID}[1]{[#1]}
% \newcommand{\IDLoc}{[\Loc]}
% \newcommand{\IDAcq}{\ID{\Acq}}
% \newcommand{\IDRel}{\ID{\Rel}}
% \newcommand{\IDR}{\ID{\mathsf{R}}}
% \newcommand{\IDW}{\ID{\mathsf{W}}}


\newcommand{\eqdef}{\mathrel{\smash{\overset{\scriptscriptstyle\vartriangle}{=}}}}
%\newcommand{\eqdef}{=}
\newcommand{\rel}{{\tt rel}}


\newcommand{\acylic}{\mathit{acyclic}}
\newcommand{\pomspace}{{\cal P}}

\newcommand{\feco}{\mathit{eco}}

\newcommand{\reads}{\mathit{Reads}}
\newcommand{\Seq}{{\tt Sequential}}

\newcommand{\writes}{\mathit{Writes}}
\newcommand{\pomf}[1]{Fun_{#1}}
\newcommand{\pomFn}{\mathit{PomFn}}
\newcommand{\power}{\mathcal{P}}
\newcommand{\aFn}{F}
\newcommand{\aRSet}{R}
\newcommand{\bRSet}{S}
\newcommand{\aWSet}{U}
\newcommand{\bWSet}{V}
\newcommand{\aWrite}{\aAct_w}
%\newcommand{\bPS}{\aPS'}
\newcommand{\cPS}{\aPS_1}
\newcommand{\dPS}{\aPS'_1}
\newcommand{\after}{\mathrel{\mathsf{after}}}
\newcommand{\size}{\mathsf{size}}

\newcommand{\test}[1]{\overline{#1}}
\newcommand{\testP}[2]{{\tt test}^{#1}_{#2}}
\newcommand{\freshaval}{\aVal_{{\tt fr}}}

%\newcommand{\jjr}[1]{\cite[#1]{DBLP:journals/pacmpl/JagadeesanJR20}}%[JJR\ifnotempty{#1}{, #1}]}
\newcommand{\jjr}[1]{\PwP\ifnotempty{#1}{(#1)}}
\newcommand{\AKA}{{\sc aka}}
\newcommand{\CSE}{{\sc cse}}
\newcommand{\CNF}{{\sc cnf}}
\newcommand{\DNF}{{\sc dnf}}
\newcommand{\UMA}{{\sc uma}}
\newcommand{\GPU}{{\sc gpu}}
\newcommand{\CPU}{{\sc cpu}}
\newcommand{\ID}{id}
\newcommand{\RMW}{{\sc rmw}}
\newcommand{\RMWs}{{\sc rmw}s}
\newcommand{\drf}{{\sc drf}}
\newcommand{\drfsc}{{\sc drf-sc}}
\newcommand{\drfra}{{\sc drf-ra}}
\newcommand{\drfpf}{{\sc drf-pf}}
\newcommand{\ldrfsc}[1]{\text{\ifemptyelse{#1}{{\sc l}}{\ensuremath{\{#1\}}{\sc -}}{\sc drf-sc}}}
\newcommand{\ldrfra}[1]{\text{\ifemptyelse{#1}{{\sc l}}{\ensuremath{\{#1\}}{\sc -}}{\sc drf-ra}}}
\newcommand{\ldrfpf}[1]{\text{\ifemptyelse{#1}{{\sc l}}{\ensuremath{\{#1\}}{\sc -}}{\sc drf-pf}}}
\newcommand{\rfub}{{\sc rfub}}
\newcommand{\oota}{{\sc oota}}
\newcommand{\jmm}{{\sc jmm}}
\newcommand{\tso}{{\sc tso}}
\newcommand{\armseven}{{\sc arm-v7}}%{\sc arm7}}
\newcommand{\EC}{{\sc ec}}
\newcommand{\EGC}{{\sc egc}}
\newcommand{\armeight}{Arm8}%{\sc arm-v8}}%{\sc arm8}}
\newcommand{\IMM}{{\sc imm}}
\newcommand{\PTX}{{\sc ptx}}
\newcommand{\ppc}{{\sc power}}
\newcommand{\rcXI}{{\sc rc11}}
\newcommand{\cXI}{{\sc c11}}
\newcommand{\mca}{{\sc mca}}
\newcommand{\iriw}{{\sc iriw}}
\newcommand{\llvm}{{\sc llvm}}
\newcommand{\ub}{{\sc ub}}





\newcommand{\rar}{\mathrel{\mathsf{ar}}}
\newcommand{\muIMM}{\ensuremath{\mu\text{IMM}}}
\newcommand{\free}{\mathsf{id}}
\newenvironment{displaymatharray}[1]{\begin{displaymath}\begin{array}{#1}\ignorespaces}{\end{array}\end{displaymath}\ignorespacesafterend}
\newenvironment{displaymatharrayl}{\begin{displaymatharray}{l}\ignorespaces}{\end{displaymatharray}\ignorespacesafterend}
\newenvironment{displaymatharrayrl}{\begin{displaymatharray}{r>{\ }l}\ignorespaces}{\end{displaymatharray}\ignorespacesafterend}
\newenvironment{sdisplaymatharray}[1]{\small\begin{displaymatharray}{#1}\ignorespaces}{\end{displaymatharray}\ignorespacesafterend}
\newenvironment{sdisplaymatharrayl}{\small\begin{displaymatharrayl}\ignorespaces}{\end{displaymatharrayl}\ignorespacesafterend}
\newenvironment{sdisplaymatharrayrl}{\small\begin{displaymatharrayrl}\ignorespaces}{\end{displaymatharrayrl}\ignorespacesafterend}
\newenvironment{displaymathsmall}{\bgroup\small\begin{displaymath}\ignorespaces}{\end{displaymath}\egroup\ignorespacesafterend}
\newenvironment{equationsmall}{\bgroup\small\begin{equation}\ignorespaces}{\end{equation}\egroup\ignorespacesafterend}
\newenvironment{scope}{\bgroup\ignorespaces}{\egroup\ignorespacesafterend}
\newenvironment{tikzinline}[1][]{\bgroup\footnotesize\begin{math}\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}\end{math}\egroup}
\newenvironment{tikzinlinesmall}[1][]{\bgroup\scriptsize\begin{math}\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}\end{math}\egroup}
\newenvironment{tikzinlinesmaller}[1][]{\bgroup\tiny\begin{math}\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}\end{math}\egroup}
\newenvironment{tikzdisplaylabel}[2][]{\bgroup\footnotesize\begin{equation}\label{#2}\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}\end{equation}\egroup\ignorespacesafterend}
\newenvironment{tikzdisplaylabeltag}[2][]{\bgroup\footnotesize\begin{equation}\label{#2}\tag{#2}\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}\end{equation}\egroup\ignorespacesafterend}
\newenvironment{tikzdisplay}[1][]{\bgroup\footnotesize\begin{displaymath}\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}\end{displaymath}\egroup\ignorespacesafterend}
\newenvironment{tikzdisplaysmall}[1][]{\bgroup\tiny\begin{displaymath}\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}\end{displaymath}\egroup\ignorespacesafterend}
\newenvironment{tikzcenter}[1][]{\begin{tikzpicture}[baselinecenter,#1]\ignorespaces}{\end{tikzpicture}}
\newcommand{\fdom}{\mathsf{dom}}
\newcommand{\fran}{\mathsf{ran}}
\newcommand{\fcodom}{\mathsf{codom}}
\newcommand{\semClosed}[1]{\closed\sem{#1}}
\newcommand{\closed}{\mathsf{closed}}
\newcommand{\addRead}{\mathsf{addRead}}
\newcommand{\pLTL}{\textsf{PLTL}}
\newcommand{\once}{\Diamond\mkern-10.1mu\text{-}\mkern4mu}
\newcommand{\always}{\Box\mkern-8.8mu\text{-}\mkern3mu}
\newcommand{\afo}{\varrho}
\newcommand{\bfo}{\vartheta}
\newcommand{\mods}{\mathsf{Models}}

\newcommand{\eqorder}{\sim}
%\newcommand{\suborder}{\sqsubseteq}
\newcommand{\inj}{f}
\newcommand{\hoare}[3]{\{#1\}\allowbreak\;#2\;\allowbreak\{#3\}}
\newcommand{\fwlp}{\textit{wlp}}
\newcommand{\fwp}[2]{\ensuremath{\textit{wp}_{#1}\ifnotempty{#2}{(#2)}}}
\newcommand{\fsp}{\textit{sp}}

\newcommand{\aF}{\xi}
\newcommand{\FA}{\mathsf{A}}
\newcommand{\FR}{\mathsf{R}}
\newcommand{\FF}{\mathsf{F}}
%\newcommand{\FID}[1]{[\DF{#1}]}

\newcommand{\xinit}{\mathsf{init}}
\newcommand{\BNFSEP}{\ensuremath{\;\mathrel{|}\;}}
\newcommand{\BNFDEF}{\ensuremath{\;\mathrel{\mathord{\vcentcolon}\mkern-1mu\mathord{\vcentcolon}\mathord{{=}}}\;}}

\newcommand{\restrict}[2]{{#1}\mathbin{|}_{#2}}
\newcommand{\textand}{\;\allowbreak\text{and}\allowbreak\;}
\newcommand{\textif}{\;\allowbreak\text{if}\allowbreak\;}
\newcommand{\textiff}{\;\allowbreak\text{iff}\allowbreak\;}
\newcommand{\textwhere}{\;\allowbreak\text{where}\allowbreak\;}
\newcommand{\textwhen}{\;\allowbreak\text{when}\allowbreak\;}
\newcommand{\textotherwise}{\;\allowbreak\text{otherwise}\allowbreak\;}
\newcommand{\textimplies}{\; \allowbreak\text{implies}\allowbreak\;}
\newcommand{\textor}{\; \allowbreak\text{or}\allowbreak\;}

\newcommand{\fpox}{\mathit{po}}
\newcommand{\fird}{\mathit{ird}}
\newcommand{\TIKZ}[2][]{\hbox{\footnotesize$\{\,\begin{tikzpicture}[baselinecenter,node distance=1em,#1]#2\end{tikzpicture}\,\}$}}
\newcommand{\fork}{\setminus_{\mathsf{S}}}

\newcommand{\refapp}[1]{Appendix~\ref{app:#1}}

\newenvironment{noenv}{\ignorespaces}{\ignorespacesafterend}
\newcommand{\aGrp}{G}
\newcommand{\aCmd}{S}
\newcommand{\aUser}{U}
\newcommand{\aTest}{T}
\newcommand{\pass}[2]{#1\mathbin{\Downarrow}#2}
% \newcommand{\bCmd}{D}
% \newcommand{\eCmd}{E}
% \newcommand{\cCmd}{B}

\newcommand{\ifnotempty}[2]{\ifx\relax#1\relax\else#2\fi}
\newcommand{\ifnotemptyelse}[3]{\ifx\relax#1\relax#3\else#2\fi}
\newcommand{\ifemptyelse}[3]{\ifx\relax#1\relax#2\else#3\fi}

\newcommand{\dontcare}{\texttt{\_}}
\newcommand{\pair}[2]{\langle#1,\,#2\rangle}
% \newcommand{\freads}{\mathsf{reads}}
% \newcommand{\fwrites}{\mathsf{writes}}
\newcommand{\rreads}{\mathsf{Rd}}
\newcommand{\rwrites}{\mathsf{Wr}}
%\newcommand{\finternalize}{\tau}%\mathsf{internalize}}

\newcommand{\Sub}{\mathcal{S}}
\newcommand{\beforeSub}{\sigma_1}
\newcommand{\afterSub}{\sigma_2}
\newcommand{\aSub}{\sigma}
\newcommand{\bSub}{\pi}

\newcommand{\Reg}{\mathcal{R}}
\newcommand{\aReg}{r}
\newcommand{\bReg}{s}
\newcommand{\cReg}{t}
\newcommand{\uReg}[1]{\mathit{s}_{#1}}
\newcommand{\uRegs}[1]{\mathcal{S}_{#1}}

\newcommand{\LR}{\mathcal{L}}
\newcommand{\aLR}{\ell}

\newcommand{\Loc}{\mathcal{X}}
\newcommand{\aLoc}{x}
\newcommand{\bLoc}{y}
\newcommand{\cLoc}{z}
\newcommand{\dLoc}{b}
\newcommand{\aLocs}{X}
\newcommand{\bLocs}{Y}
\newcommand{\cLocs}{Z}

\newcommand{\LVal}{\mathcal{L}}
\newcommand{\aLV}{\ell}
\newcommand{\bLV}{k}

\newcommand{\Val}{\mathcal{V}}
\newcommand{\aVal}{v}
\newcommand{\bVal}{w}
\newcommand{\cVal}{\ell}
\newcommand{\dVal}{k}

\newcommand{\Exp}{\mathcal{M}}
\newcommand{\aExp}{M}
\newcommand{\bExp}{N}
\newcommand{\cExp}{L}
%\newcommand{\dExp}{K}
\newcommand{\aEExp}{\mathbb{M}}
\newcommand{\bEExp}{\mathbb{N}}

\newcommand{\Formulae}{\Phi}
\newcommand{\aForm}{\phi}
\newcommand{\bForm}{\psi}
\newcommand{\cForm}{\theta}
\newcommand{\emptyForm}{\Omega}
\newcommand{\dForm}{\xi}
\newcommand{\TRUE}{\mathsf{tt}}
\newcommand{\FALSE}{\mkern.6mu\mathsf{ff}\mkern.6mu}
\newcommand{\Bool}{\mathsf{Bool}}

\newcommand{\aTr}[3][]{\LOGIC@COLOR{\tau}^{#2}_{#1}\ifnotempty{#3}{(#3)}}
\newcommand{\trd}[2]{\LOGIC@COLOR{\tau}_{#1}\ifnotempty{#2}{(#2)}}
\newcommand{\aTerm}[1][]{\LOGIC@COLOR{\checkmark}\ifnotempty{#1}{\!_{#1}}}
\newcommand{\labelingForm}{\LOGIC@COLOR{\kappa}}%\lambda_{\Formulae}}
\newcommand{\labeling}{\LABEL@COLOR{\lambda}}
\newcommand{\labelingThrd}{\LABEL@COLOR{\lambda_{\mathsf{thrd}}}}
\newcommand{\labelingLoc}{\LABEL@COLOR{\lambda_{\mathsf{loc}}}}
\newcommand{\labelingVal}{\LABEL@COLOR{\lambda_{\mathsf{val}}}}
\newcommand{\labelingMode}{\LABEL@COLOR{\lambda_{\mathsf{mode}}}}
\newcommand{\labelingScope}{\LABEL@COLOR{\lambda_{\mathsf{scope}}}}
\newcommand{\labelingAct}{\labeling}
%\newcommand{\labelingSub}{\Sub}%\lambda_{\Act}}

\newcommand{\Int}{\mathsf{SilentAct}}
\newcommand{\Ext}{\mathsf{Ext}}
\newcommand{\Rel}{\mathsf{Rel}}
\newcommand{\Acq}{\mathsf{Acq}}
\newcommand{\Act}{\mathcal{A}}
\newcommand{\aActSub}{\alpha}
\newcommand{\bActSub}{\beta}

\newcommand{\aAct}{a}
\newcommand{\bAct}{b}
%\newcommand{\cAct}{c}
%\newcommand{\dAct}{d}
\newcommand{\DRSC}[2]{\DR[\mSC]{#1}{#2}}
\newcommand{\DWSC}[2]{\DW[\mSC]{#1}{#2}}
\newcommand{\DRAcq}[2]{\DR[\mACQ]{#1}{#2}}
\newcommand{\DWRel}[2]{\DW[\mREL]{#1}{#2}}
\newcommand{\DRmode}[2]{\DR[\amode]{#1}{#2}}
\newcommand{\DWmode}[2]{\DW[\amode]{#1}{#2}}
%\newcommand{\DRreg}[4][]{\mathsf{R}^{#1}\ifnotempty{#2}{\mkern1mu#2\ifnotempty{#3}{\mkern1mu#3\ifnotempty{#4}{\mkern1mu#4}}}}
% \newcommand{\DF}[1][\mathsf{acqrel}]{\tau\mathsf{F}^{#1}}
\newcommand{\DFS}[1]{\smash{\mathsf{F}^{#1}}}
% \newcommand{\DFS}[1]{\smash{\mathsf{F}_{\mathsf{S}}^{#1}}}
\newcommand{\DFR}[1]{\smash{\mathsf{F}_{\mathsf{R}}^{#1}}}
\newcommand{\DFW}[2][]{\smash{\mathsf{F}_{\mathsf{W#1}}^{#2}}}
\newcommand{\iDR}[3][]{\tau\DR[#1]{#2}{#3}}
\newcommand{\iDW}[3][]{\tau\DW[#1]{#2}{#3}}
% \newcommand{\iDRSC}[2]{\mathsf{R^{sc}}\ifnotempty{#1}{\mkern1mu#1\mkern1mu\bot}}
% \newcommand{\iDWSC}[2]{\mathsf{W^{sc}}\ifnotempty{#1}{\mkern0mu#1\mkern1mu\bot}}
% \newcommand{\iDRmode}[2]{\mathsf{R^{\amode}}\ifnotempty{#1}{\mkern1mu#1\mkern1mu\bot}}
% \newcommand{\iDWmode}[2]{\mathsf{W^{\amode}}\ifnotempty{#1}{\mkern0mu#1\mkern1mu\bot}}
% \newcommand{\iDRAcq}[2]{\mathsf{R\ACQ}\ifnotempty{#1}{\mkern1mu#1\mkern1mu\bot}}
% \newcommand{\iDWRel}[2]{\mathsf{W\REL}\ifnotempty{#1}{\mkern0mu#1\mkern1mu\bot}}
% \newcommand{\iDR}[2]{\mathsf{R}\ifnotempty{#1}{\mkern1mu#1\mkern1mu\bot}}
% \newcommand{\iDW}[2]{\mathsf{W}\ifnotempty{#1}{\mkern0mu#1\mkern1mu\bot}}
%% \newcommand{\iDRAcq}[2]{\mathsf{\tau R^{acq}}\ifnotempty{#1}{\,#1\ifnotempty{#2}{\,#2}}}
%% \newcommand{\iDWRel}[2]{\mathsf{\tau W^{rel}}\ifnotempty{#1}{\,#1\ifnotempty{#2}{\,#2}}}
%% \newcommand{\iDR}[2]{\mathsf{\tau R}\ifnotempty{#1}{\,#1\ifnotempty{#2}{\,#2}}}
%% \newcommand{\iDW}[2]{\mathsf{\tau W}\ifnotempty{#1}{\,#1\ifnotempty{#2}{\,#2}}}
%\newcommand{\iDF}[1]{\mathsf{\tau F}_{#1}}

\newcommand{\DSB}{\mathsf{SB}}
\newcommand{\DT}[1]{\mathsf{T}\ifnotempty{#1}{\,#1}}
\newcommand{\DB}[1]{\mathsf{B}\ifnotempty{#1}{\,#1}}
\newcommand{\DC}[1]{\mathsf{C}\ifnotempty{#1}{\,#1}}

% \newcommand{\umEvs}{\overline{\dmEvs}}
% \newcommand{\dmEvs}{G}
% \newcommand{\phEvs}{F}
% \newcommand{\reEvs}{\overline{\phEvs}}
\newcommand{\dmEvs}{\overline{\umEvs}}
\newcommand{\umEvs}{S}
\newcommand{\reEvs}{R}
\newcommand{\phEvs}{\overline{\reEvs}}
%\newcommand{\umEv}{b}

\newcommand{\aEvs}{E}
\newcommand{\dEvs}{B}
\newcommand{\bEvs}{D}
\newcommand{\EAct}{A}
\newcommand{\ESub}{S}
\newcommand{\AllEvents}{\mathcal{E}}
\newcommand{\Event}{E}
\newcommand{\aEv}{e}
\newcommand{\bEv}{d}
\newcommand{\cEv}{c}
\newcommand{\dEv}{b}
\newcommand{\cEvs}{C}
\newcommand{\begEv}{b}
\newcommand{\comEv}{c}
\newcommand{\lessdoteq}{\mathrel{\raisebox{-.65ex}{$\mkern1mu\mathord{\relbar}$}\mkern-12mu\raisebox{.2ex}{$\mathord{\lessdot}$}\mkern1mu}}
%\renewcommand{\le}{\mathrel{{\color{blue}\leq}}}
%% \newcommand{\lt}{\mathrel{{\color{blue}<}}}
%% \newcommand{\gtN}{\mathrel{{\color{red!50!black}\leq}}}
%% \newcommand{\geN}{\mathrel{{\color{red!50!black}<}}}
\let\LATEX@le=\le
\renewcommand{\le}{\SYNC@COLOR{\LATEX@le}}
\newcommand{\lt}{\SYNC@COLOR{<}}
%\newcommand{\gt}{>}
%\Newcommand{\gtN}{\leq}
%\Newcommand{\gtNsp}{\mathrel{\,\mid\!\!\!>}}
% \newcommand{\ltNsp}{\mathrel{\,\mid\!\!\!<}}
% \newcommand{\geN}{<}
\newcommand{\ltdelay}{\mathrel{\LABEL@COLOR{\sqsubset}}}
\newcommand{\ledelay}{\mathrel{\LABEL@COLOR{\sqsubseteq}}}
\newcommand{\lesync}{\SYNC@COLOR{\LATEX@le}}
\newcommand{\lesyncpo}{\SYNC@COLOR{\LATEX@le_{\mathsf{po}}}}
\newcommand{\ltsync}{\SYNC@COLOR{<}}
\newcommand{\ledep}{\DEP@COLOR{\trianglelefteq}}
\newcommand{\ltdep}{\DEP@COLOR{\vartriangleleft}}
\newcommand{\leloc}{\LOC@COLOR{\sqsubseteq}}
\newcommand{\ltloc}{\LOC@COLOR{\sqsubset}}
% \newcommand{\geloc}{\LOC@COLOR{\sqsupseteq}}
% \newcommand{\gtloc}{\LOC@COLOR{\sqsupset}}
\newcommand{\leexists}{\LOC@COLOR{\sqsubsetsim}}
\newcommand{\lelocweak}{\LOC@COLOR{\sqsubseteq\mkern-6mu\makebox[0pt][r]{\raisebox{1.5pt}{\small$\scriptscriptstyle\mathsf{w}$}}\mkern2mu}}
\newcommand{\lelocstrong}{\LOC@COLOR{\sqsubseteq\mkern-8mu\makebox[0pt][r]{\raisebox{1pt}{$\scriptscriptstyle\mathsf{s}$}}\mkern4mu}}
\newcommand{\leloctwo}{\LOC@COLOR{\sqsubseteq\mkern-8mu\makebox[0pt][r]{\raisebox{1.5pt}{\small$\scriptscriptstyle\mathsf{2}$}}\mkern4mu}}
\newcommand{\ltlocweak}{\LOC@COLOR{\sqsubset\mkern-6mu\makebox[0pt][r]{\raisebox{1.5pt}{\small$\scriptscriptstyle\mathsf{w}$}}\mkern2mu}}
\newcommand{\ltlocstrong}{\LOC@COLOR{\sqsubset\mkern-8mu\makebox[0pt][r]{\raisebox{1.5pt}{$\scriptscriptstyle\mathsf{s}$}}\mkern4mu}}
\newcommand{\ltloctwo}{\LOC@COLOR{\sqsubset\mkern-8mu\makebox[0pt][r]{\raisebox{1pt}{\small$\scriptscriptstyle\mathsf{2}$}}\mkern4mu}}
% \newcommand{\lelocweak}{\mathrel{\smash{\overset{\mathsf{w}}{\sqsubseteq}}}}
% \newcommand{\lelocstrong}{\mathrel{\smash{\overset{\mathsf{s}}{\sqsubseteq}}}}
% \newcommand{\leloctwo}{\mathrel{\smash{\overset{\mathsf{2}}{\sqsubseteq}}}}
%
%\newcommand{\ltexists}{\prec}%<_\mathsf{s}}
% \newcommand{\leobs}{\sqsubseteq_\mathsf{obs}}
% \newcommand{\ltobs}{\sqsubset_\mathsf{obs}}
% \newcommand{\lesc}{\sqsubseteq_\mathsf{sc}}
% \newcommand{\ltsc}{\sqsubset_\mathsf{sc}}
\newcommand{\moral}{\mathbin{\blacktriangle}}
\newcommand{\conflict}{\mathbin{\vartriangle}}
\newcommand{\concur}{\asymp}

% \newcommand{\slt}{\vartriangleleft}
% \newcommand{\sle}{\trianglelefteq}
% \newcommand{\wlt}{\sqsubset}%\mathrel{\raisebox{.1ex}{$\lessdot$}}}
% \newcommand{\wle}{\sqsubseteq}%\lessdoteq}
% \newcommand{\wleLoc}{\mathrel{{\wle}\restrict{\Loc}}}
% \newcommand{\leLoc}{\mathrel{{\le}\restrict{\Loc}}}
% \newcommand{\wleaLoc}{\mathrel{{\wle}\restrict{\aLoc}}}
% \newcommand{\leaLoc}{\mathrel{{\le}\restrict{\aLoc}}}
% \newcommand{\gtN}{\mathrel{{\color{red!50!black}\lessdoteq}}}
% \newcommand{\geN}{\mathrel{{\color{red!50!black}\lessdot}}}

\newcommand{\Alphabet}{\Sigma}

\newcommand{\RF}{\mathsf{RF}}

\newcommand{\NEVER}[1]{\rlap{$\times$}#1}

\newcommand{\partialfun}{\mathbin\rightharpoonup}
\newcommand{\fun}{\mathbin\rightarrow}
\newcommand{\prefix}{\mathbin\Rightarrow}
\newcommand{\prefixsc}{\mathbin{{\xRightarrow{{\mathsf{sc}}}}}}
\newcommand{\prefixsimp}{\mathbin{{\xRightarrow{{\mathsf{triv}}}}}}
\newcommand{\sequence}{\mathbin;}
\newcommand{\guard}{\mathbin\rhd}
\newcommand{\downclose}[2][]{{\nabla}\ifnotempty{#1}{_{#1}}\ifnotempty{#2}{(#2)}}
\newcommand{\relfilt}[2][\amode]{\mathsf{cover}\ifnotempty{#1}{^{#1}}\ifnotempty{#2}{_{#2}}}
\newcommand{\DOT}{\mathbin.}

\newcommand{\aPS}{P}
\newcommand{\aPSS}{\mathcal{P}}
\newcommand{\bPS}{Q}
\newcommand{\bPSS}{\mathcal{Q}}

\newcommand{\aEG}{G}

\newcommand{\Term}{\mathsf{Term}}
\newcommand{\SC}{\mathsf{SC}}
\newcommand{\semcand}[1]{\textsf{cand}\ifnotempty{#1}{\llbracket#1\rrbracket}}
\newcommand{\semmin}[1]{\textsf{gen}\ifnotempty{#1}{\llbracket#1\rrbracket}}
\newcommand{\semdown}[1]{\nabla\llbracket#1\rrbracket}
\newcommand{\semsc}[1]{\llbracket#1\rrbracket_{\SC}}
%\newcommand{\semsc}[1]{\textit{SC}\llbracket#1\rrbracket}
\newcommand{\FENCE}[1]{\texttt{F}\ifnotempty{#1}{^{#1}}}
\newcommand{\INC}{\texttt{INC}}
\newcommand{\FADD}{\texttt{FADD}}
\newcommand{\CAS}{\texttt{CAS}}
\newcommand{\EXCHG}{\texttt{EXCHG}}
\newcommand{\BEGIN}{\texttt{begin}}
\newcommand{\COMMIT}{\texttt{commit}}
\newcommand{\RECOVERY}{\texttt{onabort}\texttt{\{}}
\newcommand{\ENDREC}{\texttt{\}}}
\newcommand{\NEW}{\texttt{new}\,}
\newcommand{\NULL}{\texttt{null}}
\newcommand{\BEGINVAL}{\BEGIN\,\aVal}
\newcommand{\COMMITVAL}{\COMMIT\,\aVal}
\newcommand{\RECOVERYVAL}{\texttt{onabort}\,\aVal\texttt{\{}}
\newcommand{\END}{\texttt{end}}
\newcommand{\SKIP}{\texttt{skip}}
\newcommand{\ABORT}{\texttt{abort}}
\newcommand{\NIL}{\mathsf{0}}
\newcommand{\THREAD}[1]{#1}%\texttt{thread}\ifnotempty{#1}{\;#1}}
\newcommand{\FORK}[1]{\texttt{fork}\ifnotempty{#1}{\,\THEN#1\FI}}
\newcommand{\FORKP}[1]{\FORK{#1}}%{\!\THEN#1\FI}}
\newcommand{\FORKJOIN}[1]{\texttt{fork}\ifemptyelse{#1}{\text{-}}{\,\THEN#1\FI\SEMI}\texttt{join}}
\newcommand{\FORKJOINP}[1]{\FORKJOIN{#1}}%\!\THEN#1\FI}}
\newcommand{\JOIN}{\texttt{join}}
\newcommand{\STOP}{\texttt{stop}}
\newcommand{\OR}{\mathbin{\texttt{|\!\!|}}}%\land}
\newcommand{\AND}{\mathbin{\texttt{\&\!\&}}}%\land}
\newcommand{\BANG}{\texttt{\!!}}%\lnot}%\texttt{!!}\mkern-1mu}
\newcommand{\GETS}{\mkern1mu\texttt{:}\mkern-1mu\texttt{=}\,}
%\newcommand{\SEQ}{\texttt{;}\,\allowbreak}
\newcommand{\SEMI}{\texttt{;}\,\allowbreak}
\newcommand{\PASS}{\texttt{pass}}
\newcommand{\WHILE}[1]{\texttt{while}\,\allowbreak\!\texttt{(}#1\texttt{)}}
\newcommand{\DO}{\texttt{\{}}
\newcommand{\OD}{\texttt{\}}}
\newcommand{\IF}[1]{\texttt{if}\,\allowbreak\!\texttt{(}#1\texttt{)}}
\newcommand{\THEN}{\allowbreak\texttt{\{}}
\newcommand{\ELSE}{\texttt{\}}\,\allowbreak\texttt{else}\,\allowbreak\texttt{\{}}
\newcommand{\ELIF}[1]{\ELSE\IF{#1}}
\newcommand{\brELSE}{\texttt{\}}\\\texttt{else}\,\texttt{\{}}
\newcommand{\brELIF}[1]{\texttt{\}}\\\texttt{else}\,\IF{#1}}
\newcommand{\FI}{\texttt{\}}}
\newcommand{\LOCK}{\texttt{lock()}}
\newcommand{\TERNARY}[3]{#1\texttt{?}#2\texttt{:}#3}
\newcommand{\VAR}{\texttt{var}\,}
\newcommand{\TOUCHED}{\texttt{touched}\,}
\newcommand{\REF}[1]{\mkern-2mu\texttt{[}\mkern-2mu#1 \mkern-2mu\texttt{]}\mkern-2mu}
\newcommand{\REFAcq}[1]{\REF{#1}^{\texttt{acq}}}
\newcommand{\REFRel}[1]{\REF{#1}^{\texttt{rel}}}

\newcommand{\CANREAD}{\texttt{canRead}}
\newcommand{\SEC}{\texttt{SECRET}}
\newcommand{\RETURN}{\texttt{return}\,}
\newcommand{\BARRIER}{\texttt{barrier}}

\newcommand{\EQ}{{=}}%\,\texttt{=}\,}
% \newcommand{\NOTEQ}{\,\texttt{!=}\,}
\newcommand{\NOTEQ}{\ensuremath{{\neq}}}

\newcommand{\GCC}{\ensuremath{\texttt{gcc}}}
\newcommand{\CLANG}{\ensuremath{\texttt{clang}}}

%\newcommand{\sSEMI}{\mathbin{\dot{\rule{0em}{1.15ex};}}}
% \newcommand{\sSEMI}{\mathbin{;}}
\newcommand{\sSEND}[2]{#1!\ifnotempty{#2}{\langle#2\rangle}}
\newcommand{\sRECV}[2]{#1?\ifnotempty{#2}{(#2)}}
\newcommand{\sSET}[1]{\set{#1}}
\newcommand{\sUNSET}[1]{\unset{#1}}
\newcommand{\sWAIT}[1]{\wait{#1}}
\newcommand{\sGUARD}{\guard}
\newcommand{\sPREFIX}[1][]{\mathbin{\displaystyle\mathop{\ifx\relax#1\relax\rightarrow\else\longrightarrow\fi}^{#1}}}
\newcommand{\wSEMI}{\mathbin{;}}
\newcommand{\sIF}[1]{\textnormal{\textit{IF}}\ifnotempty{#1}{\allowbreak(#1}}
\newcommand{\sTHEN}{\allowbreak,\,}
\newcommand{\sELSE}{\allowbreak,\,}
\newcommand{\sFI}{)}
\NewDocumentCommand\sIFTHEN{m m m}{\textnormal{\textit{IF}}\ifnotempty{#1}{\allowbreak(#1,\,\allowbreak#2\ifnotempty{#3}{,\,\allowbreak#3})}}
\NewDocumentCommand\xIFTHEN{m m m}{\IF{#1}\THEN#2\ifnotempty{#3}{\ELSE#3}\FI}
\NewDocumentCommand\IFTHEN{m m m}{\IF{#1}\THEN#2\ifnotempty{#3}{\ELSE#3}\FI}
%\NewDocumentCommand\sPAR{m m}{#1\PAR#2}
% \NewDocumentCommand\sRPAR{m O{} m}{#1\RPAR[#2]#3}
\NewDocumentCommand\sPAR{m m}{\textnormal{\textit{PAR}}\ifnotempty{#1}{\allowbreak(#1,\,\allowbreak#2)}}
\NewDocumentCommand\xLPAR{m O{} m}{#1\LPAR[#2]#3}
\NewDocumentCommand\xLPARP{m O{} m}{(#1\LPAR[#2]#3)}
\NewDocumentCommand\xRPAR{m O{} m}{#1\RPAR[#2]#3}
\NewDocumentCommand\xRPARP{m O{} m}{(#1\RPAR[#2]#3)}
\NewDocumentCommand\xPAR{m m}{#1\LPAR#2}
\NewDocumentCommand\xPARP{m m}{(#1\LPAR#2)}
\NewDocumentCommand\sSEMI{m m}{\textnormal{\textit{SEQ}}\ifnotempty{#1}{\allowbreak(#1,\,\allowbreak#2)}}
\NewDocumentCommand\xSEMI{m m}{{#1}\SEMI{#2}}
\NewDocumentCommand\xSEMIP{m m}{({#1}\SEMI{#2})}
% \NewDocumentCommand\sPAR{m O{} m O{}}{\sRPAR{#1}[#2]{#3}[#4]}
\NewDocumentCommand\sLET{m m O{}}{\textnormal{\textit{LET}}\ifnotempty{#1}{\allowbreak(#1,\,\allowbreak#2)_{#3}}}
\newcommand{\sEXPAND}[1]{\textnormal{\textit{EXPAND}}\ifnotempty{#1}{\allowbreak(#1)}}
\newcommand{\sFORK}[1]{\textnormal{\textit{FORK}}\ifnotempty{#1}{\allowbreak(#1)}}
\newcommand{\sFORKJOIN}[1]{\textnormal{\textit{FORKJOIN}}\ifnotempty{#1}{\allowbreak(#1)}}
\newcommand{\sTHREAD}[1]{\textnormal{\textit{THRD}}\ifnotempty{#1}{\allowbreak(#1)}}
\newcommand{\sTOP}[1]{\textnormal{\textit{TOP}}\ifnotempty{#1}{\allowbreak(#1)}}
\NewDocumentCommand{\sLOAD}{O{} m O{} m O{}}{\textnormal{\textit{READ}}\ifnotempty{#2}{\allowbreak(#2,\,\allowbreak#4\ifnotempty{#1}{,\,\allowbreak#1}\ifnotempty{#3}{\ifshowSCOPE,\,\allowbreak#3\fi})\ifshowSCOPE_{#5}\fi}}
\NewDocumentCommand{\sLOADP}{O{} m O{} m O{}}{\textnormal{\textit{READ}}'\ifnotempty{#2}{\allowbreak(#2,\,\allowbreak#4\ifnotempty{#1}{,\,\allowbreak#1}\ifnotempty{#3}{\ifshowSCOPE,\,\allowbreak#3\fi})\ifshowSCOPE_{#5}\fi}}
\NewDocumentCommand{\sSTORE}{O{} m O{} m O{}}{\textnormal{\textit{WRITE}}\ifnotempty{#2}{\allowbreak(#2,\,\allowbreak#4\ifnotempty{#1}{,\,\allowbreak#1}\ifnotempty{#3}{\ifshowSCOPE,\,\allowbreak#3\fi})\ifshowSCOPE_{#5}\fi}}
\NewDocumentCommand{\sFENCE}{O{} m O{}}{\textnormal{\textit{FENCE}}\ifnotempty{#2}{\allowbreak(#2\ifnotempty{#1}{\ifshowSCOPE,\,\allowbreak#1\fi})\ifshowSCOPE_{#3}\fi}}
\NewDocumentCommand\sCAS{O{} O{} m O{} m m m O{}}{\textnormal{\textit{CAS}}(#5,\,#3,\,#6,\,#7,\,#1,\,#2\ifshowSCOPE,\,\allowbreak#4\fi)\ifshowSCOPE_#8\fi}
\NewDocumentCommand\sFADD{O{} O{} m O{} m m O{}}{\textnormal{\textit{FADD}}(#5,\,#3,\,#6,\,#1,\,#2\ifshowSCOPE,\,\allowbreak#4\fi)\ifshowSCOPE_#7\fi}
\NewDocumentCommand\sEXCHG{O{} O{} m O{} m m O{}}{\textnormal{\textit{EXCHG}}(#5,\,#3,\,#6,\,#1,\,#2\ifshowSCOPE,\,\allowbreak#4\fi)\ifshowSCOPE_#7\fi}
\newcommand{\sSTOREtight}[3][]{\textnormal{\textit{WRITE}}\ifnotempty{#2}{\allowbreak(#2,#3\ifnotempty{#1}{,#1})}}
\newcommand{\sLOADPRE}[4][]{\textnormal{\textit{RD}}\ifnotempty{#2}{\allowbreak(#2,\,\allowbreak#3\ifnotempty{#1}{,\,\allowbreak#1},\,\allowbreak#4)}}
\newcommand{\sSTOREPRE}[4][]{\textnormal{\textit{WR}}\ifnotempty{#2}{\allowbreak(#2,\,\allowbreak#3\ifnotempty{#1}{,\,\allowbreak#1},\,\allowbreak#4)}}
\newcommand{\sSKIPPRE}{\textnormal{\textit{SKIPPRE}}}
\newcommand{\sSKIP}{\textnormal{\textit{SKIP}}}
\newcommand{\sSTOP}{\textnormal{\textit{STOP}}}
\newcommand{\sABORT}{\textnormal{\textit{ABORT}}}
\newcommand{\sNIL}{\textnormal{\textit{NIL}}}

\newcommand{\init}[1]{\mathsf{init}\,#1}
\newcommand{\release}[1]{\mathsf{release}\,#1}
\newcommand{\acquire}[1]{\mathsf{acquire}\,#1}
% \newcommand{\set}[1]{\mathsf{set}\,#1}
% \newcommand{\get}[1]{\mathsf{get}\,#1}
\newcommand{\send}[2]{\bar{#1}_{#2}}
\newcommand{\recv}[2]{{#1}_{#2}}
\newcommand{\notify}[1]{\mathsf{notify}\,#1}
\newcommand{\notified}[1]{\mathsf{notified}\,#1}
\newcommand{\wait}[1]{\mathsf{wait}\,#1}

\newcommand{\reorder}{\mathrel{\LABEL@COLOR{\bowtie}}}
\newcommand{\reorderlt}{\mathrel{\LABEL@COLOR{\ltimes}}}%\xleftrightarrow{}}%\mathrel\leftrightarrow}
\newcommand{\reorderca}{\mathrel{\LABEL@COLOR{\ltimes}}_{\mathsf{\LABEL@COLOR{ca}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\reordersc}{\mathrel{\LABEL@COLOR{\ltimes}}_{\mathsf{\LABEL@COLOR{sc}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\eqreordersc}{\mathrel{\LABEL@COLOR{\bowtie}}_{\mathsf{\LABEL@COLOR {sc}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\eqreorderloc}{\mathrel{\LABEL@COLOR{\bowtie}}_{\mathsf{\LABEL@COLOR {loc}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\eqreorderco}{\mathrel{\LABEL@COLOR{\bowtie}}_{\mathsf{\LABEL@COLOR {co}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\reorderco}{\mathrel{\LABEL@COLOR{\ltimes}}_{\mathsf{\LABEL@COLOR {co}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\reorderlws}{\mathrel{\LABEL@COLOR{\ltimes}}_{\mathsf{\LABEL@COLOR {lws}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\reorderloc}{\mathrel{\LABEL@COLOR{\ltimes}}_{\mathsf{\LABEL@COLOR {loc}}}}%\xleftrightarrow{\mathsf{co}}}
\newcommand{\reorderra}{\mathrel{\LABEL@COLOR{\ltimes}}_{\mathsf{\LABEL@COLOR {sync}}}}%\xleftrightarrow{\mathsf{sync}}}%\mathrel{\smash{\overset{\mathsf{ra}}{\leftrightarrow}}}}
\newcommand{\reorderRLX}{\mathrel{\LABEL@COLOR{\smash{\overset{\mRLX}{\leftrightarrow}}}}}
\newcommand{\reorderSC}{\mathrel{\LABEL@COLOR{\smash{\overset{\mSC}{\leftrightarrow}}}}}

%\newcommand{\quietForm}{\mathsf{Q}}
%\newcommand{\preForm} {\kappa}
% \newcommand{\reorderDepForm}{xxx}
% \newcommand{\reorderIndForm}{\rho}

\newcommand{\aChan}{\alpha}
\newcommand{\bChan}{\beta}

%% \wk[out=-30,in=-70,transform canvas={xshift=-1ex}]{wx0}{wx1}
\usepackage{tikz}
\usepackage{tikz-cd}
\tikzset{
  symbol/.style={
    draw=none,
    every to/.append style={
      edge node={node [sloped, allow upside down, auto=false]{$#1$}}}
  }
}
\tikzset{
  sqsubset/.style={
    draw=none,
    every to/.append style={
      edge node={node [sloped, allow upside down, auto=false]{$\sqsubset$}}}
  }
}
\usetikzlibrary{shapes}
\usetikzlibrary{shapes.misc}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{topaths}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{matrix}
\usetikzlibrary{fit}
\usetikzlibrary{calc}
\usetikzlibrary{matrix,fit,calc,positioning,backgrounds}
\usetikzlibrary{arrows,patterns,decorations}
\usetikzlibrary{decorations.pathreplacing}%,calligraphy}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{tikzmark}

\usetikzlibrary{shapes.misc}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{topaths}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{matrix}
\usetikzlibrary{fit}

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}

\pgfsetlayers{background,main,foreground}

\tikzstyle{oval} = [ellipse, inner xsep=#1]
\newcommand{\bgoval}[3][gray!10]{\begin{pgfonlayer}{background}\node[oval= 4pt, fill=#1, fit=#2, label=$#3$]{};\end{pgfonlayer}}
\newcommand{\bgellipse}[3][gray!10]{\begin{pgfonlayer}{background}\node[ellipse= 4pt, minimum width=8cm, fill=#1, fit=#2, label=$#3$]{};\end{pgfonlayer}}
\newcommand{\bgellipsesmaller}[3][gray!10]{\begin{pgfonlayer}{background}\node[ellipse= 4pt, minimum width=7cm, fill=#1, fit=#2, label=$#3$]{};\end{pgfonlayer}}
\newcommand{\bgovalright}[3][gray!10]{\begin{pgfonlayer}{background}\node[oval= 4pt, fill=#1, fit=#2, label={right:$#3$}]{};\end{pgfonlayer}}

%\tikzset{baselinecenter/.style= {baseline=([yshift=-1ex]current bounding box.west)} }
\tikzstyle{baselinecenter} = [baseline={([yshift=-.5ex]current bounding box.west)}]
%\tikzstyle{baselinecenter} = [baseline=(current bounding box.west)]
\tikzstyle{event} = [draw=black, fill=blue!5, rectangle, rounded corners, minimum size=3ex]
\newcommand{\event}[3]{\node[event](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{phevent} = [draw=gray, fill=gray!10, rectangle, dashed, rounded corners, minimum size=3ex]
\newcommand{\phevent}[3]{\node[phevent](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{raevent} = [event] %[draw=black, fill=red!7, double, rectangle, rounded corners, minimum size=3ex]
\newcommand{\raevent}[3]{\node[raevent](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{scevent} = [event] %[draw=black, fill=orange!20, double, thick, rectangle, rounded corners, minimum size=3ex]
\newcommand{\scevent}[3]{\node[scevent](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{xform} = [draw=gray!80!black, fill=gray!10, rectangle, minimum size=3ex]
\newcommand{\xform}[3]{\node[xform](#1)[#3]{$\mathstrut#2$};}%\mid\aForm$};}
\tikzstyle{zlbl} = [gray!70!black]
%\newcommand{\@zz}[1]{\makebox[0ex]{\smash{\raisebox{-.5ex}{{${#1}{:}\;$}}}}}
\newcommand{\@zz}[1]{\makebox[0ex]{\smash{\raisebox{.5ex}{{${}^{#1}$}}}}}
\newcommand{\@zzr}[1]{\makebox[0ex]{\smash{\raisebox{-.5ex}{{${}^{#1}$}}}}}
\newcommand{\@zzl}[1]{\makebox[0ex][r]{\smash{\raisebox{-.5ex}{{${#1}{:}$}}}}}
\newcommand{\eventl}[4]{\node[event](#2)[#4,label={[zlbl]left:\@zz{#1}}]{$\mathstrut#3$};}
\newcommand{\eventr}[4]{\node[event](#2)[#4,label={[zlbl]right:\@zz{#1}}]{$\mathstrut#3$};}
\newcommand{\eventrr}[4]{\node[event](#2)[#4,label={[zlbl]right:\@zzr{#1}}]{$\mathstrut#3$};}
\newcommand{\pheventx}[4]{\node[phevent](#2)[#4]{$\mathstrut#1:#3$};}
\newcommand{\pheventl}[4]{\node[phevent](#2)[#4,label={[zlbl]left:\@zz{#1}}]{$\mathstrut#3$};}
\newcommand{\pheventr}[4]{\node[phevent](#2)[#4,label={[zlbl]right:\@zz{#1}}]{$\mathstrut#3$};}
\newcommand{\raeventl}[4]{\node[raevent](#2)[#4,label={[zlbl]left:\@zz{#1}}]{$\mathstrut#3$};}
\newcommand{\raeventr}[4]{\node[raevent](#2)[#4,label={[zlbl]right:\@zz{#1}}]{$\mathstrut#3$};}
\newcommand{\sceventl}[4]{\node[scevent](#2)[#4,label={[zlbl]left:\@zz{#1}}]{$\mathstrut#3$};}
\newcommand{\sceventr}[4]{\node[scevent](#2)[#4,label={[zlbl]right:\@zz{#1}}]{$\mathstrut#3$};}
\tikzstyle{internal} = [color=gray, draw=gray, dashed, fill=gray!10, rectangle, rounded corners, minimum size=3ex]
\newcommand{\internal}[3]{\node[internal](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{cloudy} = [draw=black, fill=blue!10, cloud, aspect=2]
\newcommand{\cloud}[3]{\node[cloudy](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{final} = [draw=black, fill=blue!10, rectangle, rounded corners, double, minimum size=3ex]
\newcommand{\final}[3]{\node[final](#1)[#3]{$\mathstrut#2$};}
\tikzset{nonevent/.style={
        event, 
        append after command={
            node [
                fit=(\tikzlastnode),
                draw=red!50!black,
                thick,
                inner sep=-2\pgflinewidth,
                cross out
            ] {}
        }
    }
}
\tikzset{phnonevent/.style={
        phevent, 
        append after command={
            node [
                fit=(\tikzlastnode),
                draw=red!50!black,
                thick,
                inner sep=-2\pgflinewidth,
                cross out
            ] {}
        }
    }
}
\tikzset{nonfinal/.style={
        final, 
        append after command={
            node [
                fit=(\tikzlastnode),
                draw=red!50!black,
                thick,
                inner sep=-2\pgflinewidth,
                cross out
            ] {}
        }
    }
}
%% https://tex.stackexchange.com/questions/72784/arrow-with-two-colors-with-tikz
% \tikzset{
%   double -latex/.style args={#1 colored by #2 and #3}{    
%     -latex,line width=#1,#2,
%     postaction={draw,-latex,#3,line width=(#1)/3,shorten <=(#1)/4,shorten >=4.5*(#1)/3},
%   },
%   double round cap-latex/.style args={#1 colored by #2 and #3}{    
%     round cap-latex,line width=#1,#2,
%     postaction={draw,round cap-latex,#3,line width=(#1)/3,shorten <=(#1)/4,shorten >=4.5*(#1)/3},
%   },
%   double round cap-stealth/.style args={#1 colored by #2 and #3}{
%     round cap-stealth,line width=#1,#2,
%     postaction={round cap-stealth,draw,,#3,line width=(#1)/3,shorten <=(#1)/3,shorten >=2*(#1)/3},
%   },
%   double -stealth/.style args={#1 colored by #2 and #3}{
%     -stealth,line width=#1,#2,
%     postaction={-stealth,draw,,#3,line width=(#1)/3,shorten <=(#1)/3,shorten >=2*(#1)/3},
%   },
% }
\newcommand{\phnonevent}[3]{\node[phnonevent](#1)[#3]{$\mathstrut#2$};}
\newcommand{\nonevent}[3]{\node[nonevent](#1)[#3]{$\mathstrut#2$};}
\newcommand{\nonfinal}[3]{\node[nonfinal](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{race} = [-,thick,decorate,decoration={zigzag,segment length = 0.2cm, amplitude = 0.5mm},color=red!50!black]
\newcommand{\race}[3][]{\begin{pgfonlayer}{background}\draw[race,#1](#2) to (#3);\end{pgfonlayer}}
\newcommand{\xrace}{\xarrowtikz{race}{\;\;\;\;}}
\newcommand{\lrace}[1]{\xarrowtikzmath{race}{\;\text{\textcolor{black}{\emph{#1}}}\;}}

\tikzstyle{graypo} = [-latex,color=gray,]
\tikzstyle{graywk} = [->,dashed,thick,color=gray,]
\newcommand{\graypo}[3][]{\draw[graypo,#1](#2)to(#3);}
\newcommand{\graywk}[3][]{\draw[graywk,#1](#2)to(#3);}
% \newcommand{\graypo}[3][]{}
% \newcommand{\graywk}[3][]{}
\tikzstyle{liftrmw} = [->,dashed,thick,color=gray,]
%\tikzstyle{liftrmw} = [-latex,double,\wkicolor]
\newcommand{\liftrmw}[3][]{\draw[liftrmw,#1](#2)to(#3);}
\newcommand{\xliftrmw}{\xarrowtikz{liftrmw}{\;\;}}%

\tikzstyle{xo} = [-stealth,dotted,thick,color=gray!20!black,]
\tikzstyle{xright} = [out=-0,in=0,looseness=1.5,]
\tikzstyle{xleft} = [out=-180,in=180,looseness=1.5,]
\newcommand{\xos}[3][]{\draw[xo,xright,#1](#2)to(#3);}
\newcommand{\xo}[3][]{\draw[xo,#1](#2)to(#3);}
\newcommand{\xxo}{\xarrowtikz{xo}{\;\;}}%

\newcommand{\depcolor}{magenta}
\newcommand{\synccolor}{red!65!black}
\newcommand{\syncsccolor}{cyan!90!black}
\newcommand{\rfcolor}{green!50!black}
\newcommand{\wkicolor}{orange!80!black}
\newcommand{\wkcolor}{blue!70!black}
\newcommand{\hbcolor}{blue!70!black}
\newcommand{\pocolor}{cyan!50!black}
\newcommand{\mrgcolor}{orange!50!black}

\tikzstyle{liftrf} = [-latex,double,\rfcolor]
\newcommand{\liftrf}[3][]{\draw[liftrf,#1](#2)to(#3);}
\newcommand{\xliftrf}{\xarrowtikz{liftrf}{\;\;}}%
%\tikzstyle{close} = [double -latex=7pt colored by \synccolor and \rfcolor,thick]
% \tikzstyle{close} = [-latex,double,\rfcolor]
%\tikzstyle{close} = [-latex,double,line width=.7pt,color=\rfcolor,postaction={draw,-,\synccolor,line width=.7pt,shorten <=0pt,shorten >=5.5pt},]
% \newcommand{\close}[3][]{\draw[close,#1](#2)to(#3);}
% \newcommand{\xclose}{\xarrowtikz{close}{\;\;}}%

\tikzstyle{mrg} = [-latex,double,color=\mrgcolor,]
%\NewDocumentCommand \mrg {O{} m O{} m} {\draw[mrg,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{m}$}  (#4);}
\NewDocumentCommand \mrg {O{} m O{} m} {\draw[mrg,#1](#2) to (#4);}
\newcommand{\fmrg}[2][]{\ensuremath{\textcolor{\mrgcolor}{\mathsf{\pi}}\ifnotempty{#1}{_{#1}}\ifnotempty{#2}{(#2)}}}%
\newcommand{\fmrginv}[2][]{\ensuremath{\textcolor{\mrgcolor}{\mathsf{\pi^{-1}}}\ifnotempty{#1}{_{#1}}\ifnotempty{#2}{(#2)}}}%
\newcommand{\fmrginvp}[2][]{\ensuremath{\textcolor{\mrgcolor}{\mathsf{\pi^{\prime-1}}}\ifnotempty{#1}{_{#1}}\ifnotempty{#2}{(#2)}}}%
\newcommand{\rmrg}{\ensuremath{\mathrel{\textcolor{\mrgcolor}{\mathsf{\pi}}}}}%
\newcommand{\xmrg}{\xarrowtikz{mrg}{\pi}}%

\tikzstyle{pox} = [-stealth,thick,dotted,color=\pocolor,]
%\NewDocumentCommand \pox {O{} m O{} m} {\draw[pox,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{po}$}  (#4);}
\NewDocumentCommand \pox {O{} m O{} m} {\draw[pox,#1](#2) to (#4);}
\newcommand{\rpox}{\ensuremath{\mathrel{\textcolor{\pocolor}{\mathsf{po}}}}}%
\newcommand{\xpox}{\xarrowtikz{pox}{po}}%

\tikzstyle{ppo} = [-latex,thick,color=\pocolor,]
\NewDocumentCommand \ppo {O{} m O{} m} {\draw[ppo,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{ppo}$}  (#4);}
\newcommand{\rppo}{\ensuremath{\mathrel{\textcolor{\pocolor}{\mathsf{ppo}}}}}%
\newcommand{\xppo}{\xarrowtikz{ppo}{ppo}}%
\NewDocumentCommand \lob {O{} m O{} m} {\draw[ppo,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{lob}$}  (#4);}
\newcommand{\rlob}{\ensuremath{\mathrel{\textcolor{\pocolor}{\mathsf{lob}}}}}%
\newcommand{\xlob}{\xarrowtikz{ppo}{lob}}%
\NewDocumentCommand \pre {O{} m O{} m} {\draw[ppo,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{pre}$}  (#4);}
\newcommand{\rpre}{\ensuremath{\mathrel{\textcolor{\pocolor}{\mathsf{pre}}}}}%
\newcommand{\xpre}{\xarrowtikz{ppo}{pre}}%

\tikzstyle{po} = [-latex,thick,color=\depcolor,]
\newcommand{\po}[3][]{\draw[po,#1](#2)to(#3);}
\newcommand{\xpo}{\xarrowtikz{po}{\;\;}}%
\NewDocumentCommand \addr {O{} m O{} m} {\draw[po,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{addr}$}  (#4);}
\newcommand{\raddr}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{addr}}}}}%
\newcommand{\xaddr}{\xarrowtikz{po}{addr}}%
\NewDocumentCommand \ctrl {O{} m O{} m} {\draw[po,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{ctrl}$}  (#4);}
\newcommand{\rctrl}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{ctrl}}}}}%
\newcommand{\xctrl}{\xarrowtikz{po}{ctrl}}%
\NewDocumentCommand \data {O{} m O{} m} {\draw[po,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{data}$}  (#4);}
\newcommand{\rdata}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{data}}}}}%
\newcommand{\xdata}{\xarrowtikz{po}{data}}%
\NewDocumentCommand \dob {O{} m O{} m} {\draw[po,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{dob}$}  (#4);}
\newcommand{\rdob}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{dob}}}}}%
\newcommand{\xdob}{\xarrowtikz{po}{dob}}%
\NewDocumentCommand \deps {O{} m O{} m} {\draw[po,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{deps}$}  (#4);}
\newcommand{\rdeps}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{deps}}}}}%
\newcommand{\xdeps}{\xarrowtikz{po}{deps}}%
\NewDocumentCommand \dobi {O{} m O{} m} {\draw[po,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{dob'}$}  (#4);}
\newcommand{\rdobi}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{dob'}}}}}%
\newcommand{\xdobi}{\xarrowtikz{po}{dob'}}%

\tikzstyle{si} = [-latex,thick,color=\depcolor]
\NewDocumentCommand \si {O{} m O{} m} {\draw[si,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{si}$}  (#4);}
\newcommand{\rsi}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{si}}}}}%
\newcommand{\xsi}{\xarrowtikz{si}{si}}%

\tikzstyle{syncsc} = [->,thick,color=\syncsccolor]
\newcommand{\syncsc}[3][]{\draw[syncsc,#1](#2)to(#3);}
\newcommand{\xsyncsc}{\xarrowtikz{syncsc}{\;\;}}%

\tikzstyle{sync} = [-latex,thick,color=\synccolor]
\newcommand{\sync}[3][]{\draw[sync,#1](#2)to(#3);}
\newcommand{\xsync}{\xarrowtikz{sync}{\;\;}}%
\NewDocumentCommand \bob {O{} m O{} m} {\draw[sync,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{bob}$}  (#4);}
\newcommand{\rbob}{\ensuremath{\mathrel{\textcolor{\synccolor}{\mathsf{bob}}}}}%
\newcommand{\xbob}{\xarrowtikz{sync}{bob}}%

\tikzstyle{rf} = [->,thick,color=\rfcolor,]
\newcommand{\rf}[3][]{\draw[rf,#1](#2)to(#3);}
\newcommand{\rrf}{\ensuremath{\mathrel{\textcolor{\rfcolor}{\mathsf{rf}}}}}%
\newcommand{\xrf}{\xarrowtikz{rf}{\;\;}}%
\NewDocumentCommand \rfx {O{} m O{} m} {\draw[rf,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{rf}$}  (#4);}
\newcommand{\rrfx}{\ensuremath{\mathrel{\textcolor{\rfcolor}{\mathsf{rf}}}}}%
\newcommand{\rsdepx}{\ensuremath{\mathrel{\textcolor{\depcolor}{\mathsf{sdep}}}}}
\newcommand{\xrfx}{\xarrowtikz{rf}{rf}}%
\newcommand{\xrfxp}{\xarrowtikz{rf}{rf'}}%
\newcommand{\xrfxpp}{\xarrowtikz{rf}{rf''}}%
\newcommand{\xrfxppp}{\xarrowtikz{rf}{rf'''}}%
\newcommand{\xrfxinv}{\xarrowtikzrev{rf}{rf}}%
\NewDocumentCommand \rfe {O{} m O{} m} {\draw[rf,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{rfe}$}  (#4);}
\newcommand{\rrfe}{\ensuremath{\mathrel{\textcolor{\rfcolor}{\mathsf{rfe}}}}}%
\newcommand{\xrfe}{\xarrowtikz{rf}{rfe}}%
% \NewDocumentCommand \ird {O{} m O{} m} {\draw[rf,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{ird}$}  (#4);}
% \newcommand{\rird}{\ensuremath{\mathrel{\textcolor{\rfcolor}{\mathsf{ird}}}}}%
% \newcommand{\xird}{\xarrowtikz{rf}{ird}}%

\tikzstyle{rfint} = [->,dotted,thick,color=\rfcolor]
\newcommand{\rfint}[3][]{\draw[rfint,#1](#2)to(#3);}
\newcommand{\rrfint}{\ensuremath{\mathrel{\textcolor{\rfcolor}{\mathsf{rfi}}}}}%
\newcommand{\xrfint}{\xarrowtikz{rfint}{\;\;}}%
\NewDocumentCommand \rfi {O{} m O{} m} {\draw[rfint,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{rfi}$}  (#4);}
\newcommand{\rrfi}{\ensuremath{\mathrel{\textcolor{\rfcolor}{\mathsf{rfi}}}}}%
\newcommand{\xrfi}{\xarrowtikz{rfint}{rfi}}%

\tikzstyle{wki} = [-latex,thick,color=\wkicolor,]%dashed,
\newcommand{\wki}[3][]{\draw[wki,#1](#2)to(#3);}
\newcommand{\xwki}{\xarrowtikz{wki}{\;\;}}%
\NewDocumentCommand \coi {O{} m O{} m} {\draw[wki,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{coi}$}  (#4);}
\newcommand{\rcoi}{\ensuremath{\mathrel{\textcolor{\wkicolor}{\mathsf{coi}}}}}%
\newcommand{\xcoi}{\xarrowtikz{wki}{coi}}%
\NewDocumentCommand \fri {O{} m O{} m} {\draw[wki,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{fri}$}  (#4);}
\newcommand{\rfri}{\ensuremath{\mathrel{\textcolor{\wkicolor}{\mathsf{fri}}}}}%
\newcommand{\xfri}{\xarrowtikz{wki}{fri}}%
\NewDocumentCommand \poloc {O{} m O{} m} {\draw[wki,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{poloc}$}  (#4);}
\newcommand{\rpoloc}{\ensuremath{\mathrel{\textcolor{\wkicolor}{\mathsf{poloc}}}}}%
\newcommand{\xpoloc}{\xarrowtikz{wki}{poloc}}%

\tikzstyle{wk} = [->,thick,color=\wkcolor,]%dashed,
\newcommand{\wk}[3][]{\draw[wk,#1](#2)to(#3);}
\newcommand{\xwk}{\xarrowtikz{wk}{\;\;}}%
\tikzstyle{wkx} = [->,dashed,thick,color=\wkcolor,]
\newcommand{\wkx}[3][]{\draw[wkx,#1](#2)to(#3);}
\newcommand{\xwkx}{\xarrowtikz{wkx}{\;\;}}%
\tikzstyle{wky} = [->,dotted,thick,color=\wkcolor,]
\newcommand{\wky}[3][]{\draw[wky,#1](#2)to(#3);}
\newcommand{\xwky}{\xarrowtikz{wky}{\;\;}}%
\tikzstyle{wkz} = [->,dashdotted,thick,color=\wkcolor,]
\newcommand{\wkz}[3][]{\draw[wkz,#1](#2)to(#3);}
\newcommand{\xwkz}{\xarrowtikz{wkz}{\;\;}}%
\NewDocumentCommand \eco {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{eco}$}  (#4);}
\newcommand{\reco}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{eco}}}}}%
\newcommand{\recop}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{eco'}}}}}%
\newcommand{\xeco}{\xarrowtikz{wk}{eco}}%
\newcommand{\xecop}{\xarrowtikz{wk}{eco'}}%
\NewDocumentCommand \co {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{co}$}  (#4);}
\newcommand{\rco}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{co}}}}}%
\newcommand{\xco}{\xarrowtikz{wk}{co}}%
\newcommand{\xcoinv}{\xarrowtikzrev{co}{co}}%
\NewDocumentCommand \fr {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{fr}$}  (#4);}
\newcommand{\rfr}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{fr}}}}}%
\newcommand{\xfr}{\xarrowtikz{wk}{fr}}%
\newcommand{\xfrinv}{\xarrowtikzrev{wk}{fr}}%
\NewDocumentCommand \coe {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{coe}$}  (#4);}
\newcommand{\rcoe}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{coe}}}}}%
\newcommand{\xcoe}{\xarrowtikz{wk}{coe}}%
\NewDocumentCommand \fre {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{fre}$}  (#4);}
\newcommand{\rfre}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{fre}}}}}%
\newcommand{\xfre}{\xarrowtikz{wk}{fre}}%
\NewDocumentCommand \ca {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{ca}$}  (#4);}
\newcommand{\rca}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{ca}}}}}%
\newcommand{\xca}{\xarrowtikz{wk}{ca}}%
\NewDocumentCommand \cae {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{cae}$}  (#4);}
\newcommand{\rcae}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{cae}}}}}%
\newcommand{\xcae}{\xarrowtikz{wk}{cae}}%
\NewDocumentCommand \xw {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{xw}$}  (#4);}
\newcommand{\rxw}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{xw}}}}}%
\newcommand{\xxw}{\xarrowtikz{wk}{xw}}%
\NewDocumentCommand \rb {O{} m O{} m} {\draw[wk,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{fr}$}  (#4);}
\newcommand{\rrb}{\ensuremath{\mathrel{\textcolor{\wkcolor}{\mathsf{fr}}}}}%
\newcommand{\xrb}{\xarrowtikz{wk}{rb}}%

\tikzstyle{rmw} = [-latex,thick,color=\wkicolor]
\NewDocumentCommand \rmw {O{} m O{} m} {\draw[rmw,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{rmw}$}  (#4);}
\newcommand{\rrmw}{\ensuremath{\mathrel{\textcolor{\wkicolor}{\mathsf{rmw}}}}}%
\newcommand{\xrmw}{\xarrowtikz{rmw}{rmw}}%
\NewDocumentCommand \aob {O{} m O{} m} {\draw[rmw,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{aob}$}  (#4);}
\newcommand{\raob}{\ensuremath{\mathrel{\textcolor{\wkicolor}{\mathsf{aob}}}}}%
\newcommand{\xaob}{\xarrowtikz{rmw}{aob}}%

\tikzstyle{hb} = [-latex,thick,color=\hbcolor]
\NewDocumentCommand \hb {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{hb}$}  (#4);}
\newcommand{\rhb}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{hb}}}}}%
\newcommand{\rhbp}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{hb'}}}}}%
\newcommand{\xhb}{\xarrowtikz{hb}{hb}}%
\newcommand{\xhbp}{\xarrowtikz{hb}{hb'}}%
\NewDocumentCommand \ob {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{ob}$}  (#4);}
\newcommand{\rob}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{ob}}}}}%
\newcommand{\xob}{\xarrowtikz{hb}{ob}}%
\NewDocumentCommand \obi {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{ob'}$}  (#4);}
\newcommand{\robi}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{ob'}}}}}%
\newcommand{\xobi}{\xarrowtikz{hb}{ob'}}%
\NewDocumentCommand \sw {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{sw}$}  (#4);}
\newcommand{\rsw}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{sw}}}}}%
\newcommand{\xsw}{\xarrowtikz{hb}{sw}}%
\NewDocumentCommand \obs {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{obs}$}  (#4);}
\newcommand{\robs}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{obs}}}}}%
\newcommand{\xobs}{\xarrowtikz{hb}{obs}}%
% \NewDocumentCommand \cb {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{cb}$}  (#4);}
% \newcommand{\rcb}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{cb}}}}}%
% \newcommand{\xcb}{\xarrowtikz{hb}{cb}}%
\NewDocumentCommand \gcb {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{gcb}$}  (#4);}
\NewDocumentCommand \gcbz {O{} m m} {\draw[hb,#1](#2)to(#3);}
\newcommand{\rgcb}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{gcb}}}}}%
\newcommand{\xgcb}{\xarrowtikz{hb}{gcb}}%
\newcommand{\xgcbinv}{\xarrowtikzrev{hb}{gcb}}%
\NewDocumentCommand \cb {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{cb}$}  (#4);}
\NewDocumentCommand \cbz {O{} m m} {\draw[hb,#1](#2)to(#3);}
\newcommand{\rcb}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{cb}}}}}%
\newcommand{\xcb}{\xarrowtikz{hb}{cb}}%
\newcommand{\xcbinv}{\xarrowtikzrev{hb}{cb}}%
\newcommand{\rcbp}{\ensuremath{\mathrel{\textcolor{\hbcolor}{\mathsf{cb'}}}}}%
\newcommand{\xcbp}{\xarrowtikz{hb}{cb'}}%



\newsavebox{\mytempbox}
\newcommand{\xarrowtikz}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (0,0) -- node[midway,#1]{\(\scriptstyle\mathsf{#3}\)} (\wd\mytempbox,0);}}}}
\newcommand{\xarrowtikzmath}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (0,0) -- node[midway,#1]{\(\scriptstyle#3\)} (\wd\mytempbox,0);}}}}
\newcommand{\xarrowtikzlong}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (0,0) -- node[midway,#1]{\(\scriptstyle\mathsf{#3}\)} (\wd\mytempbox*1.5,0);}}}}
\newcommand{\xarrowtikzrev}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (\wd\mytempbox,0) -- node[pos=0.4,#1]{\(\scriptstyle\mathsf{#3}\)} (0,0);}}}}
\newcommand{\xarrowtikzboth}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (0,0) -- node[midway,#1]{\(\scriptstyle\mathsf{#3}\)} (\wd\mytempbox,0);
        \draw[#2] (\wd\mytempbox,0) -- (0,0);
      }}}}

\newcommand{\xarrow}[1]{\xrightarrow{\smash{#1}}}
%\newcommand{\xarrow}[1]{\xrightarrow{\raisebox{-1ex}{$\scriptstyle\smash{#1}$}}}
\newcommand{\Xarrow}[1]{\xRightarrow{#1}}

\def\@versim#1#2{\raise0.24ex\vbox{\baselineskip\z@skip\lineskip-2.4ex\ialign{$\m@th#1\hfil##\hfil$\crcr\sim\crcr#2\crcr}}}
\def\@versime#1#2{\raise0\p@\vbox{\baselineskip\z@skip\lineskip-1.6ex\ialign{$\m@th#1\hfil##\hfil$\crcr\sim\crcr#2\crcr}}}
\def\@verharpright#1#2{\raise0.24ex\vbox{\baselineskip\z@skip\lineskip-2.1ex\ialign{$\m@th#1\hfil##\hfil$\crcr{\scriptstyle\rightharpoondown}\crcr#2\crcr}}}
\def\@verharpleft#1#2{\raise0.24ex\vbox{\baselineskip\z@skip\lineskip-2.1ex\ialign{$\m@th#1\hfil##\hfil$\crcr{\scriptstyle\leftharpoondown}\crcr#2\crcr}}}
\def\@vernharpright#1#2{\raise0.24ex\vbox{\baselineskip\z@skip\lineskip-2.1ex\ialign{$\m@th#1\hfil##\hfil$\crcr{\scriptstyle\arrownot\rightharpoondown}\crcr#2\crcr}}}
\def\@vereqqright#1#2{\raise0.24ex\vbox{\baselineskip\z@skip\lineskip-2.1ex\ialign{$\m@th#1\hfil##\hfil$\crcr{\scriptscriptstyle=}\crcr#2\crcr}}}
\def\@vereqqleft#1#2{\raise0.24ex\vbox{\baselineskip\z@skip\lineskip-2.1ex\ialign{$\m@th#1\hfil##\hfil$\crcr{\scriptscriptstyle=}\crcr#2\crcr}}}
\def\VDash{\mathrel{\rule{.08ex}{1.54ex}\mkern-2.4mu\vDash}}
\newcommand{\sqsubseteqq}{\mathrel{\mathpalette\@vereqqright\sqsubset}}%eqq
\newcommand{\sqsupseteqq}{\mathrel{\mathpalette\@vereqqleft\sqsupset}}%eqq
\newcommand{\sqsubsetharp}{\mathrel{\mathpalette\@verharpright\sqsubset}}%harpoon
\newcommand{\sqsupsetharp}{\mathrel{\mathpalette\@verharpleft\sqsupset}}%harpoon
\newcommand{\sqsubsetnharp}{\mathrel{\mathpalette\@vernharpright\sqsubset}}%harpoon
\newcommand{\sqsubsetsim}{\mathrel{\mathpalette\@versim\sqsubset}}%sim
\newcommand{\sqsupsetsim}{\mathrel{\mathpalette\@versim\sqsupset}}%sim
\newcommand{\eqqsim}{\mathrel{\mathpalette\@versime=}}%sim

\providecommand*{\Dashv}{%
  \mathrel{%
    \mathpalette\@Dashv\vDash
  }%
}
\newcommand*{\@Dashv}[2]{%
  \reflectbox{$\m@th#1#2$}%
}

% Local Variables:
% mode: latex
% TeX-master: "paper"
% End:
